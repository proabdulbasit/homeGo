(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{166:function(e,t,s){},227:function(e,t){},377:function(e,t,s){"use strict";s.r(t);var a=s(1),i=s.n(a),c=s(28),n=s.n(c),l=(s(166),s(4)),o=s(8),r=s(151);const d="/api/";var h=s.n(r).a.create({withCredentials:!0});const j={get:(e,t)=>p(e,"GET",t),post:(e,t)=>p(e,"POST",t),put:(e,t)=>p(e,"PUT",t),delete:(e,t)=>p(e,"DELETE",t)};async function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{return(await h({url:"".concat(d).concat(e),method:t,data:s,params:"GET"===t?s:null})).data}catch(a){throw console.log("Had Issues ".concat(t,"ing to the backend, endpoint: ").concat(e,", with data: ").concat(s)),console.dir(a),a.response&&401===a.response.status&&window.location.assign("/#/login"),a}}const m={query:function(e){return j.get("stay",e)},getById:function(e){return j.get("stay/".concat(e))},remove:function(e){return j.delete("stay/".concat(e))},update:async function(e){return await j.put("stay/".concat(e._id),e)},add:async function(e){return await j.post("stay",e)},getTopRatedStays:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loc:{address:""},guests:{adults:1,kids:0},type:"top rated"};return await j.get("stay",e)},getNearbyStays:async function(e){return await j.get("stay",{loc:{address:""},guests:{adults:1,kids:0},type:"nearby",data:e})},getHostStays:async function(e){return await j.get("stay",{loc:{address:""},guests:{adults:1,kids:0},type:"host",data:e})},getUserWishlist:async function(e){return j.get("stay",{loc:{address:""},guests:{adults:1,kids:0},type:"wishlist",data:e})}};window.stayService=m;const b={makeId:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;for(var t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=s.charAt(Math.floor(Math.random()*s.length));return t},makeLorem:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;var t=["The sky","above","the port","was","the color of television","tuned","to","a dead channel",".","All","this happened","more or less",".","I","had","the story","bit by bit","from various people","and","as generally","happens","in such cases","each time","it","was","a different story",".","It","was","a pleasure","to","burn"],s="";for(;e>0;)e--,s+=t[Math.floor(Math.random()*t.length)]+" ";return s},getRandomIntInclusive:function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},getTimeFormat:function(e){var t=(e=new Date(e)).getDay()+1,s=e.getMonth()+1,a=e.getFullYear();return"".concat(u(t)," / ").concat(u(s)," / ").concat(a)}};function u(e){return e<10?"0".concat(e):e}var g=s(0);function O(e){let{review:t}=e;return Object(g.jsxs)("section",{className:"review-preview",children:[Object(g.jsxs)("div",{className:"review-header",children:[Object(g.jsx)("img",{src:t.user.imgUrl,alt:"user"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:t.user.fullname}),Object(g.jsx)("h4",{children:b.getTimeFormat(t.user.time)})]})]}),Object(g.jsx)("div",{className:"review-body",children:Object(g.jsx)("h2",{children:t.txt})})]})}function x(e){let{reviews:t}=e;return Object(g.jsx)("section",{className:"review-list",children:t.map((e=>Object(g.jsx)(O,{review:e},Math.random())))})}var y=s(23),v=s.n(y),f=s.p+"static/media/avatar.e582e4ba.png";class N extends a.Component{constructor(){super(...arguments),this.state={review:{txt:"",avgRate:0,categories:{Cleanliness:0,Accuracy:0,Communication:0,Location:0,"Check-in":0,Accessibility:0},user:{_id:"123456789",fullname:"Guest",imgUrl:f,time:Date.now()}}},this.clearForm=()=>{this.setState({review:{...this.state.review,txt:"",avgRate:0,categories:{Cleanliness:0,Accuracy:0,Communication:0,Location:0,"Check-in":0,Accessibility:0}}})},this.handleRateChange=(e,t)=>{this.setState({review:{...this.state.review,categories:{...this.state.review.categories,[t]:e}}})},this.handleChange=e=>{let{target:t}=e;const{value:s}=t;this.setState({review:{...this.state.review,txt:s}})},this.saveReview=()=>{const{review:e}=this.state,{categories:t}=e;let s=0;for(const i in t)s+=t[i];const a=this.props.loggedInUser;a&&(e.user.imgUrl=a.imgUrl,e.user.fullname=a.fullname,e.user._id=a._id,e.user.time=Date.now()),e.avgRate=s/6,e._id=b.makeId(),this.props.addReview(e),this.clearForm()}}componentDidMount(){const e=this.props.loggedInUser;e&&this.setState({review:{...this.state.review,user:{_id:e._id,fullname:e.username,imgUrl:e.imgUrl,time:Date.now()}}})}componentDidUpdate(e){e.loggedInUser&&e.loggedInUser!==this.props.loggedInUser&&this.setState({review:{...this.state.review,user:{_id:this.props.loggedInUser._id,fullname:this.props.loggedInUser.username,imgUrl:this.props.loggedInUser.imgUrl,time:Date.now()}}})}render(){const{loggedInUser:e}=this.props,t=e?e.imgUrl:f,s=e?e.fullname:"Guest";return Object(g.jsxs)("section",{className:"stay-add-review",children:[Object(g.jsx)("h2",{children:"Add review"}),Object(g.jsxs)("div",{className:"add-review-header",children:[Object(g.jsx)("img",{src:t,alt:"avater"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:s}),Object(g.jsx)("h4",{children:b.getTimeFormat(Date.now())})]})]}),Object(g.jsxs)("div",{className:"stay-add-review-ctgs",children:[Object(g.jsxs)("div",{className:"ctg-statistics",children:[Object(g.jsx)("label",{htmlFor:"",children:"Location"}),Object(g.jsx)(v.a,{count:5,onChange:e=>{this.handleRateChange(e,"Location")},size:20,isHalf:!0,activeColor:"#ff385c"})]}),Object(g.jsxs)("div",{className:"ctg-statistics",children:[Object(g.jsx)("label",{htmlFor:"",children:"Check-in"}),Object(g.jsx)(v.a,{count:5,onChange:e=>{this.handleRateChange(e,"Check-in")},size:20,isHalf:!0,activeColor:"#ff385c"})]}),Object(g.jsxs)("div",{className:"ctg-statistics",children:[Object(g.jsx)("label",{htmlFor:"",children:"Accessibility"}),Object(g.jsx)(v.a,{count:5,onChange:e=>{this.handleRateChange(e,"Accessibility")},size:20,isHalf:!0,activeColor:"#ff385c"})]}),Object(g.jsxs)("div",{className:"ctg-statistics",children:[Object(g.jsx)("label",{htmlFor:"",children:"Communication"}),Object(g.jsx)(v.a,{count:5,onChange:e=>{this.handleRateChange(e,"Communication")},size:20,isHalf:!0,activeColor:"#ff385c"})]}),Object(g.jsxs)("div",{className:"ctg-statistics",children:[Object(g.jsx)("label",{htmlFor:"",children:"Accuracy"}),Object(g.jsx)(v.a,{count:5,onChange:e=>{this.handleRateChange(e,"Accuracy")},size:20,isHalf:!0,activeColor:"#ff385c"})]}),Object(g.jsxs)("div",{className:"ctg-statistics",children:[Object(g.jsx)("label",{htmlFor:"",children:"Cleanliness-in"}),Object(g.jsx)(v.a,{id:"clean",classNames:"rate-clean",count:5,onChange:e=>{this.handleRateChange(e,"Cleanliness")},size:20,isHalf:!0,activeColor:"#ff385c"})]})]}),Object(g.jsxs)("div",{className:"add-review-txt",children:[Object(g.jsx)("textarea",{type:"text",name:"txt",autoComplete:"off",onChange:this.handleChange,value:this.state.review.txt,placeholder:"Write your opinion about this stay..."}),Object(g.jsx)("button",{onClick:this.saveReview,children:" send "})]})]})}}var S=s(13),w=s(153);class C extends a.Component{constructor(){super(...arguments),this.state={startDate:new Date,endDate:new Date,key:"selection"},this.handleSelect=e=>{this.setState({startDate:e.selection.startDate,endDate:e.selection.endDate,key:"selection"},(()=>{this.props.handleDates(this.state)}))}}render(){return Object(g.jsx)(w.DateRange,{editableDateInputs:!0,ranges:[this.state],moveRangeOnFirstSelection:!1,onChange:this.handleSelect})}}const k={query:function(){return function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):null}(U)},remove:function(){return T(U,null)},add:function(e){return T(U,e)},getTopCities:function(){return[{city:"Hong Kong",state:"China",imgUrl:"https://a0.muscache.com/im/pictures/be4d3ba5-08d7-4afe-95a7-f2da6453886a.jpg?im_q=medq&im_w=240"},{city:"Bangkok",state:"Thailand",imgUrl:"https://a0.muscache.com/im/pictures/7253e011-7c22-48fd-b75d-d0da35372397.jpg?im_q=medq&im_w=240"},{city:"London",state:"England",imgUrl:"https://a0.muscache.com/im/pictures/52e8083e-2de2-446d-a860-534eab250541.jpg?im_q=medq&im_w=240"},{city:"Paris",state:"France",imgUrl:"https://a0.muscache.com/im/pictures/20e74de0-0eb8-4fca-afb8-b111875acdf5.jpg?im_q=medq&im_w=240"},{city:"Dubai",state:"United Arab Emirates",imgUrl:"https://a0.muscache.com/im/pictures/e639b7ab-aee3-48ee-9743-216684a51319.jpg?im_q=medq&im_w=240"},{city:"New York",state:"United States",imgUrl:"https://a0.muscache.com/im/pictures/ca3737ef-0faf-46ba-b055-b4a2d99e2cea.jpg?im_q=medq&im_w=240"},{city:"Amsterdam",state:"Netherlands",imgUrl:"https://a0.muscache.com/im/pictures/585d1e53-e2e1-4baf-a34e-36301dd1e2da.jpg?im_q=medq&im_w=240"},{city:"Tel Aviv",state:"Israel",imgUrl:"https://a0.muscache.com/im/pictures/7c309a70-bc93-4603-8d3b-9d4cd9bf75b2.jpg?im_q=medq&im_w=240"}]}},U="trip";function T(e,t){return localStorage[e]=JSON.stringify(t),t}window.tripService=k;const M={query:D,remove:function(e){return j.delete("order/".concat(e))},add:async function(e,t,s){const a={createdAt:Date.now(),endDate:e.time.checkOut,startDate:e.time.checkIn,guests:e.guests,host:t.host,status:"wait for approval",totalPrice:e.totalPrice,user:s,stay:t};return k.remove(),await j.post("order",a)},update:async function(e){return await j.put("order/".concat(e._id),e)},getHostOrders:async function(e){var t=D("order",{id:e,type:"host"});return t=t.filter((t=>t.host._id===e))},getUserOrders:async function(e){var t=D("order",{id:e,type:"user"});return t=t.filter((t=>t.host._id===e))}};async function D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:null,type:"all",filterBy:{num:1,name:""}};const t=await j.get("order",e);return t}window.orderService=M;const I={login:async function(e){const t=await j.post("auth/login",e);if(t)return _(t)},logout:async function(){return sessionStorage.clear(),await j.post("auth/logout")},signup:async function(e){const t=Math.random()>.5?"men":"women";e.imgUrl="https://randomuser.me/api/portraits/".concat(t,"/").concat(b.getRandomIntInclusive(0,100),".jpg");return _(await j.post("auth/signup",e))},getById:function(e){return console.log("getById: ",e),j.get("user/".concat(e))},update:async function(e){const t=await j.put("user/".concat(e._id),e);A()._id===t._id&&_(t);return t},getLoggedinUser:A};function A(){return JSON.parse(sessionStorage.getItem("loggedinUser")||"null")}function _(e){return sessionStorage.setItem("loggedinUser",JSON.stringify(e)),e}function P(){return async e=>{try{e({type:"SET_USERS",users:await I.getUsers()})}catch(t){console.log("UserActions: err in loadUsers",t)}}}function E(e){return async t=>{try{t({type:"SET_USER",user:await I.login(e)})}catch(s){console.log("UserActions: err in login",s)}}}function R(){return async e=>{try{await I.logout(),e({type:"SET_USER",user:null})}catch(t){console.log("UserActions: err in logout",t)}}}window.userService=I;var F=s(154),H=s.n(F);const L=function(){var e=null;const t={async setup(){e||(await j.get("setup-session"),e=H()("",{reconnection:!1}),!0)},async on(s,a){e||await t.setup(),e.on(s,a)},async off(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e||await t.setup(),a?e.off(s,a):e.removeAllListeners(s)},async emit(s,a){e||await t.setup(),e.emit(s,a)},terminate(){e=null,!1}};return t}();window.socketService=L;L.setup();class W extends a.Component{constructor(){super(...arguments),this.state={trip:{guests:{adults:0,kids:0},loc:{address:""},time:{checkIn:"",checkOut:""}},isAvailable:!1,dynamicModal:{modalContent:"",modalPosition:{}}},this.onSetModal=(e,t)=>{const s={x:e.pageX,y:e.pageY};this.setState({dynamicModal:{...this.state.dynamicModal,modalPosition:s}},(()=>{this.openModal(t)}))},this.handleDates=e=>{var t=e.startDate.toDateString(),s=e.endDate.toDateString();this.setState({trip:{...this.state.trip,time:{checkIn:t,checkOut:s}}})},this.openModal=e=>{const t={},{x:s,y:a}=this.state.dynamicModal.modalPosition;switch(e){case"date":t.modalContent=Object(g.jsx)("section",{className:"dynamic-modal-child book-date-modal",children:Object(g.jsx)(C,{handleDates:this.handleDates})}),t.modalPosition={top:a+20,left:s};break;case"book-guests":const{kids:e,adults:i}=this.state.trip.guests;t.modalContent=Object(g.jsxs)("section",{className:"book-guest-modal",children:[Object(g.jsxs)("div",{className:"modal-label",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:"Adults"}),Object(g.jsx)("span",{children:"Ages 13 or above"})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{className:"modal-btn",type:"button",onClick:()=>{this.handleChange({target:{name:"adults",type:"number",value:i-1}})},children:"-"}),Object(g.jsx)("span",{children:i}),Object(g.jsx)("button",{className:"modal-btn",type:"button",onClick:()=>{this.handleChange({target:{name:"adults",type:"number",value:i+1}})},children:"+"})]})]}),Object(g.jsxs)("div",{className:"modal-label",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:"Kids"}),Object(g.jsx)("span",{children:"Ages 2\u201312"})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{className:"modal-btn",type:"button",onClick:()=>{this.handleChange({target:{name:"kids",type:"number",value:e-1}})},children:"-"}),Object(g.jsx)("span",{children:e}),Object(g.jsx)("button",{className:"modal-btn",type:"button",onClick:()=>{this.handleChange({target:{name:"kids",type:"number",value:e+1}})},children:"+"})]})]})]}),t.modalPosition={top:a,left:s};break;case"":t.modalContent="",t.modalPosition={top:0,left:0,height:0,width:0}}this.props.setModalContent(t,e)},this.handleChange=e=>{e.timeStamp&&e.preventDefault();const{name:t,value:s,type:a}=e.target;if("date"===a)this.setState({trip:{...this.state.trip,time:{...this.state.trip.time,[t]:s}}});else if("number"===a){if(s<0)return;const e=this.state.trip.guests.adults+this.state.trip.guests.kids,a=this.state.trip.guests[t]<s;if(e===this.props.stay.capacity&&a)return;this.setState({trip:{...this.state.trip,guests:{...this.state.trip.guests,[t]:+s}}},(()=>{this.openModal("book-guests")}))}else this.setState({trip:{...this.state.trip,loc:{...this.state.trip.loc,[t]:s}}})},this.toggleAvailability=()=>{const{guests:e,time:t}=this.state.trip;e.adults+e.kids<1?this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"fas fa-exclamation"}),Object(g.jsx)("h2",{children:"Please enter guest number"})]})):t.checkIn&&t.checkOut?this.setState({isAvailable:!this.state.isAvailable},(()=>{this.props.onSearch(this.state.trip)})):this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"fas fa-exclamation"}),Object(g.jsx)("h2",{children:"Please enter trip dates"})]}))},this.onReserveTrip=async()=>{const{trip:e}=this.state,{stay:t,loggedInUser:s,login:a}=this.props;if(!s)return void this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("h2",{children:"You must log in frist"}),Object(g.jsx)(l.b,{to:"/login",children:"Login"}),Object(g.jsx)("button",{className:"demo-user-btn",onClick:()=>{a({username:"mor",password:"1111"})},children:"Demo User"})]}));e.totalPrice=(e.guests.kids+e.guests.adults)*t.price*this.getTripTime();const i=await this.props.addOrder(e,t,s);L.emit("ORDER_OUT",i),this.setState({trip:{guests:{adults:0,kids:0},loc:{address:""},time:{checkIn:"",checkOut:""}},isAvailable:!1}),this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"far fa-check-circle"}),Object(g.jsx)("h3",{children:"Your order has sent to the host"})]}))},this.getTripTime=()=>(new Date(this.state.trip.time.checkOut).getTime()-new Date(this.state.trip.time.checkIn).getTime())/1e3/60/60/24,this.getCells=()=>{const e=[];for(var t=0;t<100;t++)e.push(Object(g.jsx)("div",{className:"cell"},Math.random()));return e}}componentDidMount(){const e=this.props.trip||{guests:{adults:0,kids:0},loc:{address:""},time:{checkIn:"",checkOut:""}};this.setState({trip:e,isAvailable:!1})}componentDidUpdate(e){e.modalType!==this.props.modalType&&this.openModal(this.props.modalType)}render(){const{stay:e,getTotalRate:t}=this.props,{trip:s,isAvailable:a}=this.state,{time:i}=s,{checkIn:c,checkOut:n}=i,{reviews:l,price:o}=e;return Object(g.jsx)("section",{className:"order-form-container",children:Object(g.jsxs)("div",{className:"order-form-sticky",children:[Object(g.jsxs)("div",{className:"order-form",children:[Object(g.jsxs)("div",{className:"order-form-header",children:[Object(g.jsxs)("p",{children:[Object(g.jsxs)("span",{className:"order-price",children:["$",s.guests.kids+s.guests.adults===0?o:((s.guests.kids+s.guests.adults)*o).toLocaleString("en-US")]})," / night"]}),Object(g.jsxs)("span",{className:"stay-rate-display",children:[Object(g.jsx)("i",{className:"fas fa-star"}),t(),Object(g.jsxs)("p",{children:[" (",l.length," reviews) "]})]})]}),Object(g.jsxs)("form",{children:[Object(g.jsxs)("div",{className:"order-form-date-picker",children:[Object(g.jsxs)("label",{htmlFor:"check-in",className:"check-in",children:[Object(g.jsx)("span",{children:"Check in"}),Object(g.jsx)("input",{defaultValue:c,id:"check-in",autoComplete:"off",placeholder:"Add dates",onClick:e=>this.onSetModal(e,"date")})]}),Object(g.jsxs)("label",{htmlFor:"check-out",className:"check-out",children:[Object(g.jsx)("span",{children:"Check out"}),Object(g.jsx)("input",{defaultValue:n,id:"check-out",autoComplete:"off",placeholder:"Add dates",onClick:e=>this.onSetModal(e,"date")})]})]}),Object(g.jsxs)("label",{className:"guests-lable",children:[Object(g.jsx)("span",{children:"Guests"}),Object(g.jsx)("input",{onClick:e=>{this.onSetModal(e,"book-guests")},name:"guests",value:s.guests.kids+s.guests.adults,type:"text",placeholder:"Add guests",onChange:this.handleChange})]}),Object(g.jsxs)("div",{className:"book-stay-btn book-stay-btn-container",onClick:a?this.onReserveTrip:this.toggleAvailability,children:[this.getCells(),Object(g.jsx)("div",{className:"content",children:Object(g.jsx)("button",{className:"action-btn",children:Object(g.jsx)("span",{children:a?"Reserve":"Check availability"})})})]}),a&&Object(g.jsxs)("div",{className:"book-info",children:[Object(g.jsx)("h4",{children:"You won't be charged yet"}),Object(g.jsxs)("h3",{children:[Object(g.jsxs)("span",{children:["$",o.toLocaleString("en-US")," X ",this.getTripTime()," night",this.getTripTime()>1&&"s"]})," ",Object(g.jsxs)("span",{children:["$",((s.guests.kids+s.guests.adults)*o*this.getTripTime()).toLocaleString("en-US")]})]}),Object(g.jsxs)("h3",{children:[Object(g.jsx)("span",{children:"Cleaning fee"})," ",Object(g.jsxs)("span",{children:["$",6*this.getTripTime()]})]}),Object(g.jsxs)("h3",{children:[Object(g.jsx)("span",{children:"Service fee"})," ",Object(g.jsxs)("span",{children:["$",17*this.getTripTime()]})]}),Object(g.jsxs)("h5",{children:[Object(g.jsx)("span",{children:"Total"}),Object(g.jsxs)("span",{children:["$",(6*this.getTripTime()*17+(s.guests.kids+s.guests.adults)*o*this.getTripTime()).toLocaleString("en-US")]})]})]})]})]}),Object(g.jsxs)("span",{className:"report-listing-btn",children:[Object(g.jsx)("i",{className:"fab fa-font-awesome-flag"}),Object(g.jsx)("p",{children:"Report this listing"})]})]})})}}const q={addOrder:function(e,t,s){return async a=>{try{const i=await M.add(e,t,s);return a({type:"ADD_ORDER",order:i}),i}catch(i){console.log("OrderActions: err in addOrder",i)}}},login:E},B=Object(S.b)((e=>({loggedInUser:e.userModule.loggedInUser,trip:e.tripModule.trip})),q)(W);var Y=s(42);class G extends a.Component{constructor(){super(...arguments),this.state={lat:-8.61308,lng:41.1413}}componentDidMount(){this.setState({lat:this.props.pos.lat,lng:this.props.pos.lng})}render(){return Object(g.jsx)("section",{className:"google-map",children:Object(g.jsxs)(Y.Map,{className:"map",google:this.props.google,zoom:14,initialCenter:{lat:this.state.lat,lng:this.state.lng},center:this.state,children:[Object(g.jsx)(Y.Marker,{position:this.state,name:"Current location"}),Object(g.jsx)(Y.InfoWindow,{visible:!0,position:this.state,children:Object(g.jsx)("div",{children:Object(g.jsx)("h1",{children:"Your next trip is here!"})})})]})})}}const V=Object(Y.GoogleApiWrapper)({apiKey:"AIzaSyCUEnEL-D59JCymx_6jmOZ6FkBaCKTYTTI"})(G);var $,J=s(155),z=s(96),K=s(156),X=s.n(K);const Z=Object(z.css)($||($=Object(J.a)(["\n  display: block;\n  margin: 0 auto;\n  border-color: red;\n"])));function Q(){let[e]=Object(a.useState)(!0),[t]=Object(a.useState)("#FF385C");return Object(g.jsx)("div",{className:"BeatLoader main-loader page main",children:Object(g.jsx)(X.a,{color:t,loading:e,css:Z,size:20})})}class ee extends a.Component{constructor(){super(...arguments),this.state={stay:null,toggleWish:""},this.scrollUp=()=>{window.scroll({top:0,behavior:"smooth"})},this.setWishList=()=>{const e=this.props.loggedInUser;if(!e.wishlist)return;-1!==e.wishlist.findIndex((e=>e===this.state.stay._id))&&this.setState({...this.state,toggleWish:!0})},this.loadStay=async()=>{const{stayId:e}=this.props.match.params,t=await m.getById(e);this.setState({stay:t}),this.props.loggedInUser&&this.setWishList()},this.setWishList=()=>{const e=this.props.loggedInUser;if(!e.wishlist)return;-1!==e.wishlist.findIndex((e=>e===this.state.stay._id))&&this.setState({...this.state,toggleWish:!0})},this.onAddToWishList=()=>{const e=this.props.loggedInUser;if(e){if(e.wishlist){const t=e.wishlist.find((e=>e===this.state.stay._id));if(t){let s=e.wishlist.findIndex((e=>e===t));this.setState({...this.state,toggleWish:!1}),e.wishlist.splice(s,1)}else this.setState({...this.state,toggleWish:!0}),e.wishlist.push(this.state.stay._id)}else e.wishlist=[this.state.stay._id];this.props.updateUser(e)}else this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("h2",{children:"You must log in frist"}),Object(g.jsx)(l.b,{to:"/login",children:"Login"}),Object(g.jsx)("button",{className:"demo-user-btn",onClick:()=>{this.props.login({username:"mor",password:"1111"})},children:"Demo User"})]}))},this.getTotalRate=()=>{const e=this.state.stay.reviews.map((e=>e.avgRate)),t=e.reduce(((e,t)=>e+=t),0);return 0===t?"new":(t/e.length).toFixed(2)},this.getStayReviewStatistics=()=>{const{reviews:e}=this.state.stay,t=e.length;if(!e)return;const s={Cleanliness:0,Accuracy:0,Communication:0,Location:0,"Check-in":0,Accessibility:0};e.forEach((e=>{for(const t in e.categories)s[t]+=e.categories[t]}));for(const i in s)s[i]=+(s[i]/t).toFixed(2);const a=[];for(const i in s)a.push(Object(g.jsxs)("div",{className:"ctg-statistics",children:[Object(g.jsx)("h3",{children:i}),Object(g.jsx)(v.a,{count:5,value:s[i],size:20,isHalf:!0,edit:!1,activeColor:"#ff385c"})]},Math.random()));return a},this.addReview=e=>{const{stay:t}=this.state;t.reviews.push(e),this.props.updateStay(t),this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"far fa-check-circle"}),Object(g.jsx)("h3",{children:"Your review has been saved"})]}))}}async componentDidMount(){this.scrollUp(),await this.loadStay(),this.props.setHomePage("stay")}getAmenityIcon(e){switch(e){case"TV":return Object(g.jsx)("i",{className:"fas fa-tv"});case"Wifi":return Object(g.jsx)("i",{className:"fas fa-wifi"});case"Air conditioning":return Object(g.jsx)("i",{className:"fas fa-fan"});case"Smoking allowed":return Object(g.jsx)("i",{className:"fas fa-smoking"});case"Pets allowed":return Object(g.jsx)("i",{className:"fas fa-paw"});case"Cooking basics":return Object(g.jsx)("i",{className:"fas fa-blender"});default:return Object(g.jsx)("i",{className:"fab fa-airbnb"})}}render(){const{stay:e}=this.state;if(!e)return Object(g.jsx)(Q,{});const{loggedInUser:t,toggleMsgModal:s,onSearch:a,openDynamicModal:i,modalType:c,setModalContent:n}=this.props,{toggleWish:l}=this.state,{loc:o,capacity:r,desc:d,amenities:h,stayType:j,propertyType:p,reviews:m,name:b,host:u}=e;return Object(g.jsxs)("main",{className:"stay-details-container narrow",children:[Object(g.jsxs)("section",{className:"stay-details-header",children:[Object(g.jsx)("h1",{children:b}),Object(g.jsxs)("div",{className:"stay-short-info",children:[Object(g.jsxs)("div",{children:[Object(g.jsxs)("span",{className:"stay-rate-display",children:[Object(g.jsx)("i",{className:"fas fa-star"}),Object(g.jsx)("span",{children:this.getTotalRate()}),Object(g.jsxs)("p",{children:[" ( ",m.length," reviews )"]})]}),Object(g.jsx)("span",{children:"\u2022"}),Object(g.jsx)("p",{children:o.address})]}),Object(g.jsxs)("div",{className:"action-btn-container",children:[Object(g.jsx)("button",{children:Object(g.jsxs)("p",{children:[Object(g.jsx)("i",{className:"fas fa-external-link-alt"}),"share"]})}),Object(g.jsx)("button",{onClick:this.onAddToWishList,className:"stay-save-btn",children:Object(g.jsxs)("p",{children:[Object(g.jsx)("i",{className:l?"fas fa-heart":"far fa-heart"}),"save"]})})]})]})]}),Object(g.jsx)("div",{id:"stay-gallery",className:"stay-gallery",children:e.imgUrls.map(((e,t)=>t<5?Object(g.jsx)("img",{src:e,alt:"stay-gallery-preview-img"},Math.random()):""))}),Object(g.jsxs)("section",{className:"stay-info-container",children:[Object(g.jsxs)("div",{className:"stay-long-info",children:[Object(g.jsxs)("div",{className:"stay-long-info-header",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"".concat(p," hosted by ").concat(u.fullname)}),Object(g.jsxs)("span",{children:[r," guests \u2022 ",j," \u2022 ",p]})]}),Object(g.jsx)("img",{src:u.imgUrl,alt:"avatar"})]}),Object(g.jsxs)("div",{className:"stay-feature-container",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("i",{className:"fas fa-home"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:j}),Object(g.jsx)("h4",{children:"entire place"===j?"You'll have the place to yourself.":"You'll have a private room to yourself."})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("i",{className:"fas fa-book-open"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:"House rules"}),Object(g.jsx)("h4",{children:"This place isn\u2019t suitable for children under 12 and the host doesn\u2019t allow pets."})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("i",{className:"fas fa-medal"}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("h3",{children:[u.fullname," is a Superhost"]}),Object(g.jsx)("h4",{children:"Superhosts are experienced, highly rated hosts who are committed to providing great stays for guests."})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("i",{className:"fas fa-bookmark"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:"Wifi"}),Object(g.jsx)("h4",{children:"Guests often search for this popular amenity"})]})]})]}),Object(g.jsxs)("div",{className:"description",children:[Object(g.jsx)("h2",{children:"Description"}),Object(g.jsx)("span",{children:d})]}),Object(g.jsxs)("div",{id:"amenities",className:"amenities-list",children:[Object(g.jsx)("h2",{children:"Amenities"}),Object(g.jsx)("ul",{children:h.map((e=>Object(g.jsxs)("li",{children:[Object(g.jsx)("span",{children:this.getAmenityIcon(e)}),Object(g.jsx)("span",{children:e})]},Math.random())))})]})]}),Object(g.jsx)(B,{stay:e,getTotalRate:this.getTotalRate,onSearch:a,loggedInUser:t,toggleMsgModal:s,openDynamicModal:i,modalType:c,setModalContent:n})]}),Object(g.jsxs)("section",{className:"stay-review-container",children:[Object(g.jsxs)("div",{className:"stay-review-header",children:[Object(g.jsx)("h2",{children:Object(g.jsxs)("span",{className:"stay-rate-display",children:[Object(g.jsx)("i",{className:"fas fa-star"}),this.getTotalRate()," ",Object(g.jsxs)("p",{children:[" (",m.length," reviews)"]})]})}),Object(g.jsx)("div",{className:"stay-review-ststistics",children:this.getStayReviewStatistics().map((e=>e))})]}),Object(g.jsx)(x,{reviews:m})]}),Object(g.jsx)("section",{className:"stay-review",children:Object(g.jsx)(N,{loggedInUser:t,addReview:this.addReview})}),Object(g.jsxs)("section",{className:"stay-details-map",children:[Object(g.jsx)("h2",{children:"Location"}),Object(g.jsx)("h3",{children:o.address}),Object(g.jsx)(V,{pos:o})]})]})}}var te=s.p+"static/media/user-lock.b5a4d298.PNG",se=s.p+"static/media/user-card.45d2a01a.PNG";class ae extends a.Component{constructor(){super(...arguments),this.state={user:"",isEditMode:!1},this.loadUser=async()=>{let e=sessionStorage.getItem("loggedinUser");e=JSON.parse(e);const t=await I.getById(e._id);this.setState({user:t})},this.handleChange=e=>{let{target:t}=e;const{name:s}=t,{value:a}=t;this.setState({user:{...this.state.user,[s]:a}})},this.onUpdateUser=()=>{this.props.updateUser(this.state.user),this.toggleEditMode()},this.toggleEditMode=()=>{this.setState({isEditMode:!this.state.isEditMode})}}componentDidMount(){this.loadUser(),this.props.setFooterDisplay(!1),this.props.setHomePage("user")}componentWillUnmount(){this.props.setFooterDisplay(!0)}render(){const e=this.state.user;if(!e)return Object(g.jsx)("h1",{children:"loading..."});const{fullname:t,username:s,email:a,imgUrl:i}=e,c=this.state.isEditMode;return Object(g.jsxs)("main",{className:"user-details main page",children:[Object(g.jsx)("h1",{children:"Personal info"}),Object(g.jsxs)("section",{className:"main-user-details",children:[!c&&Object(g.jsxs)("div",{className:"user-details-info",children:[Object(g.jsxs)("div",{className:"user-info-header",children:[Object(g.jsx)("img",{src:i,alt:"avatar"}),Object(g.jsxs)("span",{children:[Object(g.jsx)("h4",{children:"Hello "+t}),Object(g.jsx)("p",{children:"It's nice to have you with us"})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"full name"}),Object(g.jsxs)("p",{children:[" ",t]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"username"}),Object(g.jsx)("p",{children:s})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"email"}),Object(g.jsx)("p",{children:a})]}),Object(g.jsx)("button",{onClick:this.toggleEditMode,children:"Edit"})]}),c&&Object(g.jsxs)("div",{className:"user-details-info user-edit",children:[Object(g.jsxs)("div",{className:"user-info-header",children:[Object(g.jsx)("img",{src:i,alt:"avatar"}),Object(g.jsxs)("span",{children:[Object(g.jsx)("h4",{children:"Hello "+t}),Object(g.jsx)("p",{children:"It's nice to have you with us"})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"full name"}),Object(g.jsx)("p",{children:Object(g.jsx)("input",{type:"text",name:"fullname",autoComplete:"off",onChange:this.handleChange,value:t})})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"username"}),Object(g.jsx)("p",{children:Object(g.jsx)("input",{type:"text",name:"username",autoComplete:"off",onChange:this.handleChange,value:s})})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"email"}),Object(g.jsx)("p",{children:Object(g.jsx)("input",{type:"text",name:"email",autoComplete:"off",onChange:this.handleChange,value:a})})]}),Object(g.jsx)("button",{onClick:this.onUpdateUser,children:"save"})]}),Object(g.jsxs)("section",{className:"general-info-container",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("img",{src:te,alt:"lock"}),Object(g.jsx)("h3",{children:"Which details can be edited?"}),Object(g.jsx)("p",{children:"Details Airbnb uses to verify your identity can\u2019t be changed. Contact info and some personal details can be edited, but we may ask you verify your identity the next time you book or create a listing."})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("img",{src:se,alt:"card"}),Object(g.jsx)("h3",{children:"What info is shared with others?"}),Object(g.jsx)("p",{children:"Airbnb only releases contact information for hosts and guests after a reservation is confirmed."})]})]})]})]})}}var ie=s(157),ce=s.n(ie);function ne(e){let{stay:t}=e;return Object(g.jsxs)(ce.a,{dots:!1,infinite:!0,arrows:!0,speed:500,slidesToShow:1,slidesToScroll:1,className:"stay-preview-slider",children:[Object(g.jsx)("div",{children:Object(g.jsx)("img",{src:t.imgUrls[0],alt:""})}),Object(g.jsx)("div",{children:Object(g.jsx)("img",{src:t.imgUrls[1],alt:""})}),Object(g.jsx)("div",{children:Object(g.jsx)("img",{src:t.imgUrls[2],alt:""})}),Object(g.jsx)("div",{children:Object(g.jsx)("img",{src:t.imgUrls[3],alt:""})})]})}function le(e){let{stay:t,loggedInUser:s,updateUser:a,toggleMsgModal:i,login:c,trip:n,addTrip:o,stayType:r,loadWishlist:d}=e;return Object(g.jsxs)("section",{className:"stay-preview-container",children:[Object(g.jsxs)(l.b,{to:"/stay/".concat(t._id),onClick:function(){var e=n;e.stay=t,o(e)},className:"stay-preview-link",children:[Object(g.jsx)(ne,{stay:t}),Object(g.jsxs)("div",{className:"stay-preview-info",children:[Object(g.jsxs)("span",{className:"stay-preview-rate",children:[Object(g.jsx)("i",{className:"fas fa-star"}),Object(g.jsx)("p",{children:(()=>{const e=t.reviews.map((e=>e.avgRate)),s=e.reduce(((e,t)=>e+=t),0);return 0===s?"new":(s/e.length).toFixed(1)})()}),Object(g.jsxs)("p",{children:["( ",t.reviews.length," )"]})]}),Object(g.jsxs)("h3",{children:[Object(g.jsx)("span",{children:t.propertyType}),"\u2022",Object(g.jsx)("span",{children:t.loc.address.substring(0,t.loc.address.indexOf(","))})]}),Object(g.jsx)("h3",{children:t.name}),Object(g.jsxs)("h3",{className:"stay-price",children:[Object(g.jsxs)("span",{children:["$",t.price]})," / night"]})]})]}),Object(g.jsx)("button",{className:"stay-preview-save-btn",onClick:()=>{!function(e){if(!s)return i(Object(g.jsxs)("span",{children:[Object(g.jsx)("h2",{children:"You must log in frist"}),Object(g.jsx)(l.b,{to:"/login",children:"Login"}),Object(g.jsx)("button",{className:"demo-user-btn",onClick:()=>{c({username:"mor",password:"1111"})},children:"Demo User"})]})),!1;if(s.wishlist){let t=s.wishlist.findIndex((t=>t===e));-1!==t?s.wishlist.splice(t,1):s.wishlist.push(e)}else s.wishlist=[e];a(s),"wish"===r&&d(s)}(t._id)},children:(h=t._id,s&&s.wishlist&&s.wishlist.find((e=>e===h))?Object(g.jsx)("i",{className:"fas fa-heart"}):Object(g.jsx)("i",{className:"fas fa-heart off"}))})]});var h}function oe(e){let{stays:t,loggedInUser:s,updateUser:a,toggleMsgModal:i,login:c,trip:n,addTrip:l,loadWishlist:o,stayType:r}=e;return Object(g.jsx)("section",{className:"stay-list",children:t.map((e=>Object(g.jsx)(le,{updateUser:a,loggedInUser:s,stay:e,toggleMsgModal:i,stayType:r,login:c,trip:n,addTrip:l,loadWishlist:o},Math.random())))})}class re extends a.Component{constructor(){var e;super(...arguments),e=this,this.state={dynamicModal:{modalContent:"",modalPosition:{}}},this.onSetModal=(e,t)=>{const{x:s,y:a}=e.target.getBoundingClientRect(),i={x:s,y:a+30};this.setState({dynamicModal:{...this.state.dynamicModal,modalPosition:i}},(()=>{this.openModal(t)}))},this.resetFilter=()=>{this.setState({stayFilterBy:{placeType:"",propertyType:"",price:250,amenities:{TV:!1,Wifi:!1,"Air conditioning":!1,"Smoking allowed":!1,"Pets allowed":!1,"Cooking basics":!1}}},(()=>{this.props.onfilterStays(this.state.stayFilterBy)}))},this.handleChange=function(t,s){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a?e.setState({stayFilterBy:{...e.state.stayFilterBy,amenities:{...e.state.stayFilterBy.amenities,[t]:s}}},(()=>{e.openModal("amenities"),e.props.onfilterStays(e.state.stayFilterBy)})):e.setState({stayFilterBy:{...e.state.stayFilterBy,[t]:s}},(()=>{"price"===t&&e.openModal("price"),e.props.onfilterStays(e.state.stayFilterBy)}))},this.openModal=e=>{const{price:t,amenities:s}=this.state.stayFilterBy,a={},{x:i,y:c}=this.state.dynamicModal.modalPosition;switch(e){case"placeType":a.modalContent=Object(g.jsx)("section",{className:"stay-filter-modal",children:Object(g.jsxs)("div",{className:"modal-label",children:[Object(g.jsxs)("div",{onClick:()=>this.handleChange("placeType","entire place"),children:[Object(g.jsx)("h4",{children:"Entire place"}),Object(g.jsx)("h5",{children:"You'll have the place to yourself"})]}),Object(g.jsxs)("div",{onClick:()=>this.handleChange("placeType","private room"),children:[Object(g.jsx)("h4",{children:"Private room"}),Object(g.jsx)("h5",{children:"You'll have a private room to yourself"})]})]})}),a.modalPosition={top:c,left:i};break;case"propertyType":a.modalContent=Object(g.jsx)("section",{className:"stay-filter-modal",children:Object(g.jsxs)("div",{className:"modal-label",children:[Object(g.jsx)("div",{onClick:()=>this.handleChange("propertyType","loft"),children:Object(g.jsx)("span",{children:"Loft"})}),Object(g.jsx)("div",{onClick:()=>this.handleChange("propertyType","studio"),children:Object(g.jsx)("span",{children:"Studio"})}),Object(g.jsx)("div",{onClick:()=>this.handleChange("propertyType","penthouse"),children:Object(g.jsx)("span",{children:"Penthouse"})}),Object(g.jsx)("div",{onClick:()=>this.handleChange("propertyType","appartment"),children:Object(g.jsx)("span",{children:"Appartment"})}),Object(g.jsx)("div",{onClick:()=>this.handleChange("propertyType","hotel"),children:Object(g.jsx)("span",{children:"Hotel"})}),Object(g.jsx)("div",{onClick:()=>this.handleChange("propertyType","villa"),children:Object(g.jsx)("span",{children:"villa"})})]})}),a.modalPosition={top:c,left:i};break;case"price":a.modalContent=Object(g.jsx)("section",{className:"stay-filter-modal",children:Object(g.jsx)("div",{className:"modal-label",children:Object(g.jsxs)("div",{className:"price",children:[Object(g.jsx)("button",{className:"modal-btn",type:"button",onClick:()=>{this.handleChange("price",t-10)},children:"-"}),Object(g.jsx)("span",{children:t}),Object(g.jsx)("button",{className:"modal-btn",type:"button",onClick:()=>{this.handleChange("price",t+10)},children:"+"})]})})}),a.modalPosition={top:c,left:i};break;case"amenities":a.modalContent=Object(g.jsx)("section",{className:"stay-filter-modal",children:Object(g.jsxs)("div",{className:"modal-label amenities",children:[Object(g.jsx)("div",{className:s.TV?"clicked":"unclicked",onClick:()=>this.handleChange("TV",!s.TV,!0),children:Object(g.jsx)("span",{children:"TV"})}),Object(g.jsx)("div",{className:s.Wifi?"clicked":"unclicked",onClick:()=>this.handleChange("Wifi",!s.Wifi,!0),children:Object(g.jsx)("span",{children:"Wifi"})}),Object(g.jsx)("div",{className:s["Air conditioning"]?"clicked":"unclicked",onClick:()=>this.handleChange("Air conditioning",!s["Air conditioning"],!0),children:Object(g.jsx)("span",{children:"AC"})}),Object(g.jsx)("div",{className:s["Smoking allowed"]?"clicked":"unclicked",onClick:()=>this.handleChange("Smoking allowed",!s["Smoking allowed"],!0),children:Object(g.jsx)("span",{children:"Smoking allowed"})}),Object(g.jsx)("div",{className:s["Pets allowed"]?"clicked":"unclicked",onClick:()=>this.handleChange("Pets allowed",!s["Pets allowed"],!0),children:Object(g.jsx)("span",{children:"Pets allowed"})}),Object(g.jsx)("div",{className:s["Cooking basics"]?"clicked":"unclicked",onClick:()=>this.handleChange("Cooking basics",!s["Cooking basics"],!0),children:Object(g.jsx)("span",{children:"Cooking basics"})})]})}),a.modalPosition={top:c,left:i};break;case"":a.modalContent="",a.modalPosition={top:0,left:0,height:0,width:0}}this.props.setModalContent(a,e)}}componentDidMount(){this.resetFilter()}componentDidUpdate(e){e.modalType!==this.props.modalType&&this.openModal(this.props.modalType)}render(){return Object(g.jsxs)("section",{className:"stay-filter",children:[Object(g.jsx)("button",{onClick:e=>{this.onSetModal(e,"placeType")},children:"Type of place"}),Object(g.jsx)("button",{onClick:e=>{this.onSetModal(e,"propertyType")},children:"Property type"}),Object(g.jsx)("button",{onClick:e=>{this.onSetModal(e,"price")},children:"Price"}),Object(g.jsx)("button",{onClick:e=>{this.onSetModal(e,"amenities")},children:"Amenities"}),Object(g.jsx)("button",{onClick:this.resetFilter,children:"Clear"})]})}}class de extends a.Component{constructor(){super(...arguments),this.state={stays:[]},this.onfilterStays=e=>{var t=function(e,t){let s=[];return e.forEach((e=>{(function(e,t){return""===t||e.stayType===t})(e,t.placeType)&&function(e,t){return""===t||e.propertyType===t}(e,t.propertyType)&&function(e,t){return e.price<=t}(e,t.price)&&function(e,t){var s=!0;for(const a in t)!0!==t[a]||e.amenities.find((e=>e===a))||(s=!1);return s}(e,t.amenities)&&(Math.random()<.5?s.unshift(e):s.push(e))})),s}(this.props.stays,e);this.setState({stays:t})},this.scrollUp=()=>{window.scrollTo({top:0,behavior:"smooth"})}}componentDidMount(){this.setState({stays:this.props.stays}),this.props.setHomePage("explore"),this.scrollUp()}componentDidUpdate(e){e.stays!==this.props.stays&&this.setState({stays:this.props.stays})}render(){const{trip:e,loggedInUser:t,updateUser:s,openDynamicModal:a,closeDynamicModal:i,setModalContent:c,toggleMsgModal:n,login:l,addTrip:o}=this.props,{stays:r}=this.state;return r?Object(g.jsxs)("main",{className:"explore-container main page",children:[Object(g.jsxs)("span",{children:[r.length," stays"]}),""===e.loc.address&&Object(g.jsxs)("h1",{children:["Find place to stay ",e&&e.loc&&e.loc.address&&"in ".concat(e.loc.address)]}),""!==e.loc.address&&Object(g.jsxs)("h1",{children:["Stays ",e&&e.loc&&e.loc.address&&"in ".concat(e.loc.address)]}),Object(g.jsx)(re,{openDynamicModal:a,closeDynamicModal:i,setModalContent:c,onfilterStays:this.onfilterStays}),Object(g.jsx)(oe,{stays:r,stayType:"explor",updateUser:s,loggedInUser:t,toggleMsgModal:n,login:l,trip:e,addTrip:o})]}):Object(g.jsx)(Q,{})}}class he extends a.Component{constructor(){super(...arguments),this.scrollUp=()=>{window.scroll({top:0,behavior:"smooth"})}}componentDidMount(){this.props.loadWishlist(this.props.loggedInUser),this.props.setHomePage("wishlist")}render(){const{stays:e,loggedInUser:t,toggleMsgModal:s,login:a,updateUser:i,trip:c,addTrip:n,loadWishlist:l}=this.props;return this.scrollUp(),Object(g.jsxs)("main",{className:"explore-container wishlist main page",children:[Object(g.jsxs)("span",{children:[e.length," stays"]}),Object(g.jsx)("h1",{children:"Wishlist"}),Object(g.jsx)(oe,{stays:e,stayType:"wish",updateUser:i,toggleMsgModal:s,loggedInUser:t,login:a,trip:c,addTrip:n,loadWishlist:l})]})}}class je extends a.Component{constructor(){super(...arguments),this.state={msg:"",loginCred:{username:"",password:""},signupCred:{username:"",password:"",fullname:"",email:""},formType:"login"},this.loginHandleChange=e=>{const{name:t,value:s}=e.target;this.setState((e=>({loginCred:{...e.loginCred,[t]:s}})))},this.signupHandleChange=e=>{const{name:t,value:s}=e.target;this.setState((e=>({signupCred:{...e.signupCred,[t]:s}})))},this.doLogin=async e=>{e.preventDefault();const{username:t,password:s}=this.state.loginCred;if(!t)return this.setState({msg:"Please enter user/password"});const a={username:t,password:s};try{await this.props.login(a),this.props.loggedInUser&&L.emit("LOGIN",this.props.loggedInUser),this.setState({loginCred:{username:"",password:""}},this.props.history.go(-1))}catch(i){this.setState({msg:"Login failed, try again."})}},this.doSignup=async e=>{e.preventDefault();const{username:t,password:s,fullname:a,email:i}=this.state.signupCred;if(!t||!s||!a||!i)return this.setState({msg:"All inputs are required"});const c={username:t,password:s,fullname:a,email:i};await this.props.signup(c),this.props.loggedInUser&&L.emit("LOGIN",this.props.loggedInUser),this.setState({signupCred:{username:"",password:"",fullname:"",email:""}},this.props.history.go(-1))},this.removeUser=e=>{this.props.removeUser(e)},this.toggleFormType=()=>{const e="login"===this.state.formType?"signup":"login";this.setState({formType:e})}}componentDidMount(){this.props.setFooterDisplay(!1)}componentWillUnmount(){this.props.setFooterDisplay(!0)}render(){let e=Object(g.jsxs)("form",{className:"login-form",onSubmit:this.doSignup,children:[Object(g.jsx)("div",{className:"login-form-header",children:Object(g.jsx)("h2",{children:"Sign Up"})}),Object(g.jsxs)("div",{className:"login-form-body",children:[Object(g.jsx)("h1",{children:"Welcome to Home and go"}),Object(g.jsx)("input",{type:"text",name:"fullname",value:this.state.signupCred.fullname,onChange:this.signupHandleChange,placeholder:"Full name",autoComplete:"fullname"}),Object(g.jsx)("input",{name:"password",type:"password",value:this.state.signupCred.password,onChange:this.signupHandleChange,placeholder:"Password",autoComplete:"current-password"}),Object(g.jsx)("input",{type:"text",name:"username",value:this.state.signupCred.username,onChange:this.signupHandleChange,placeholder:"Username",autoComplete:"username"}),Object(g.jsx)("input",{type:"text",name:"email",value:this.state.signupCred.email,onChange:this.signupHandleChange,placeholder:"email",autoComplete:"email"}),Object(g.jsx)("button",{className:"login-btn",type:"submit",children:"sign up"}),Object(g.jsx)("div",{className:"login-actions-btn",children:Object(g.jsxs)("button",{type:"button",className:"toggle-form-btn",onClick:this.toggleFormType,children:[" ","I already have an account"]})})]})]}),t=Object(g.jsxs)("form",{className:"login-form",onSubmit:this.doLogin,children:[Object(g.jsx)("div",{className:"login-form-header",children:Object(g.jsx)("h2",{children:"Log in"})}),Object(g.jsxs)("div",{className:"login-form-body",children:[Object(g.jsx)("h1",{children:"Welcome back "}),Object(g.jsx)("input",{type:"text",name:"username",autoComplete:"off",value:this.state.loginCred.username,onChange:this.loginHandleChange,placeholder:"Username"}),Object(g.jsx)("input",{type:"password",name:"password",autoComplete:"off",value:this.state.loginCred.password,onChange:this.loginHandleChange,placeholder:"Password"}),Object(g.jsx)("button",{type:"submit",className:"login-btn",children:"submit"}),Object(g.jsxs)("div",{className:"login-actions-btn",children:[Object(g.jsx)("button",{type:"button",className:"toggle-form-btn",onClick:this.toggleFormType,children:"New user?"}),Object(g.jsx)("button",{type:"button",className:"forgot-password-btn",onClick:()=>{alert("Tough Luck")},children:"Forgot Password?"})]})]})]});const{loggedInUser:s}=this.props,{formType:a}=this.state;return Object(g.jsxs)("main",{className:"login-container main page",children:[Object(g.jsx)("p",{children:this.state.msg}),s&&Object(g.jsx)("button",{onClick:this.props.logout,children:"logged out"}),Object(g.jsxs)("section",{className:"login-forms-container",children:[!s&&"login"===a&&t,!s&&"signup"===a&&e]}),s&&s.isAdmin&&Object(g.jsx)("section",{className:"admin",children:Object(g.jsxs)("details",{children:[Object(g.jsx)("summary",{children:"Admin"}),Object(g.jsx)("button",{onClick:this.props.loadUsers,children:"Refresh Users"}),this.props.isLoading&&Object(g.jsx)(Q,{}),this.props.users&&Object(g.jsx)("ul",{children:this.props.users.map((e=>Object(g.jsxs)("li",{children:[Object(g.jsx)("pre",{children:JSON.stringify(e,null,2)}),Object(g.jsxs)("button",{onClick:()=>{this.removeUser(e._id)},children:["Remove ",e.username]})]},Math.random())))})]})})]})}}const pe={login:E,logout:R,signup:function(e){return async t=>{try{t({type:"SET_USER",user:await I.signup(e)})}catch(s){console.log("UserActions: err in signup",s)}}},removeUser:function(e){return async t=>{try{await I.remove(e),t({type:"REMOVE_USER",userId:e})}catch(s){console.log("UserActions: err in removeUser",s)}}},loadUsers:P},me=Object(S.b)((e=>({users:e.userModule.users,loggedInUser:e.userModule.loggedInUser,isLoading:e.systemModule.isLoading})),pe)(je);function be(e){let{stays:t,addTrip:s}=e;return Object(g.jsx)("section",{className:"filter-gallery",children:t.map(((e,t)=>t<4?Object(g.jsxs)(l.b,{to:"/stay/".concat(e._id),onClick:()=>function(e){s({guests:{adults:1,kids:0},loc:{address:""},time:{checkIn:"",checkOut:""},stay:e})}(e),children:[Object(g.jsx)("div",{className:"gallery-preview-img",children:Object(g.jsx)("img",{src:"".concat(e.imgUrls[0]),alt:e.name})}),Object(g.jsx)("h3",{children:e.name})]},Math.random()):""))})}function ue(e){let{name:t,btnTxt:s,title:a,subtitle:i,loggedInUser:c}=e;return Object(g.jsx)("section",{className:"banner "+t,children:Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{children:a}),Object(g.jsx)("h2",{children:i}),"Become a host"===a&&Object(g.jsx)("button",{children:Object(g.jsx)(l.b,{to:c?"/host/".concat(c._id):"/host",children:s})}),"Become a host"!==a&&Object(g.jsx)("button",{children:s})]})})}function ge(e){let{loadStays:t,addTrip:s}=e;return Object(g.jsx)("section",{className:"main-hero full",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{children:"Discover stays to live, work, or just relax."}),Object(g.jsx)("button",{onClick:async function(){await s({guests:{adults:1,kids:0},loc:{address:""},time:{checkIn:"",checkOut:""}}),t()},children:Object(g.jsx)(l.b,{to:"/explore",children:"Explore now"})})]})})}function Oe(e){let{onSearch:t}=e;function s(e){t({guests:{adults:1,kids:0},loc:{address:e},time:{checkIn:"",checkOut:""}})}return Object(g.jsxs)("main",{className:"top-cities-gallery",children:[Object(g.jsxs)(l.b,{to:"/explore",onClick:()=>{s("Hong Kong")},className:"top-cities-card",children:[Object(g.jsx)("img",{src:"https://a0.muscache.com/im/pictures/be4d3ba5-08d7-4afe-95a7-f2da6453886a.jpg?im_q=medq&im_w=240",alt:"TopCities"}),Object(g.jsxs)("div",{className:"city-details-container",children:[Object(g.jsx)("h3",{children:"Hong Kong"}),Object(g.jsx)("div",{className:"city-details",children:Object(g.jsx)("h4",{children:"China"})})]})]}),Object(g.jsxs)(l.b,{to:"/explore",onClick:()=>{s("Bangkok")},className:"top-cities-card",children:[Object(g.jsx)("img",{src:"https://a0.muscache.com/im/pictures/7253e011-7c22-48fd-b75d-d0da35372397.jpg?im_q=medq&im_w=240",alt:"TopCities"}),Object(g.jsxs)("div",{className:"city-details-container",children:[Object(g.jsx)("h3",{children:"Bangkok"}),Object(g.jsx)("div",{className:"city-details",children:Object(g.jsx)("h4",{children:"Thailand"})})]})]}),Object(g.jsxs)(l.b,{to:"/explore",onClick:()=>{s("London")},className:"top-cities-card",children:[Object(g.jsx)("img",{src:"https://a0.muscache.com/im/pictures/52e8083e-2de2-446d-a860-534eab250541.jpg?im_q=medq&im_w=240",alt:"TopCities"}),Object(g.jsxs)("div",{className:"city-details-container",children:[Object(g.jsx)("h3",{children:"London"}),Object(g.jsx)("div",{className:"city-details",children:Object(g.jsx)("h4",{children:"England"})})]})]}),Object(g.jsxs)(l.b,{to:"/explore",onClick:()=>{s("Paris")},className:"top-cities-card",children:[Object(g.jsx)("img",{src:"https://a0.muscache.com/im/pictures/20e74de0-0eb8-4fca-afb8-b111875acdf5.jpg?im_q=medq&im_w=240",alt:"TopCities"}),Object(g.jsxs)("div",{className:"city-details-container",children:[Object(g.jsx)("h3",{children:"Paris"}),Object(g.jsx)("div",{className:"city-details",children:Object(g.jsx)("h4",{children:"France"})})]})]}),Object(g.jsxs)(l.b,{to:"/explore",onClick:()=>{s("Dubai")},className:"top-cities-card",children:[Object(g.jsx)("img",{src:"https://a0.muscache.com/im/pictures/e639b7ab-aee3-48ee-9743-216684a51319.jpg?im_q=medq&im_w=240",alt:"TopCities"}),Object(g.jsxs)("div",{className:"city-details-container",children:[Object(g.jsx)("h3",{children:"Dubai"}),Object(g.jsx)("div",{className:"city-details",children:Object(g.jsx)("h4",{children:"United Arab Emirates"})})]})]}),Object(g.jsxs)(l.b,{to:"/explore",onClick:()=>{s("New York")},className:"top-cities-card",children:[Object(g.jsx)("img",{src:"https://a0.muscache.com/im/pictures/ca3737ef-0faf-46ba-b055-b4a2d99e2cea.jpg?im_q=medq&im_w=240",alt:"TopCities"}),Object(g.jsxs)("div",{className:"city-details-container",children:[Object(g.jsx)("h3",{children:"New York"}),Object(g.jsx)("div",{className:"city-details",children:Object(g.jsx)("h4",{children:"United States"})})]})]}),Object(g.jsxs)(l.b,{to:"/explore",onClick:()=>{s("Amsterdam")},className:"top-cities-card",children:[Object(g.jsx)("img",{src:"https://a0.muscache.com/im/pictures/585d1e53-e2e1-4baf-a34e-36301dd1e2da.jpg?im_q=medq&im_w=240",alt:"TopCities"}),Object(g.jsxs)("div",{className:"city-details-container",children:[Object(g.jsx)("h3",{children:"Amsterdam"}),Object(g.jsx)("div",{className:"city-details",children:Object(g.jsx)("h4",{children:"Netherlands"})})]})]}),Object(g.jsxs)(l.b,{to:"/explore",onClick:()=>{s("Tel Aviv")},className:"top-cities-card",children:[Object(g.jsx)("img",{src:"https://a0.muscache.com/im/pictures/7c309a70-bc93-4603-8d3b-9d4cd9bf75b2.jpg?im_q=medq&im_w=240",alt:"TopCities"}),Object(g.jsxs)("div",{className:"city-details-container",children:[Object(g.jsx)("h3",{children:"Tel Aviv"}),Object(g.jsx)("div",{className:"city-details",children:Object(g.jsx)("h4",{children:"Israel"})})]})]})]})}class xe extends a.Component{constructor(){super(...arguments),this.scrollUp=()=>{window.scrollTo({top:0,behavior:"smooth"})},this.explorAll=async()=>{await this.props.addTrip({guests:{adults:1,kids:0},loc:{address:""},time:{checkIn:"",checkOut:""}}),this.props.loadStays()}}componentDidMount(){this.props.setHomePage("home"),this.scrollUp()}componentWillUnmount(){this.props.setHomePage("")}render(){const{loggedInUser:e,onSearch:t,topRatedStays:s,nearbayStays:a,loadStays:i,addTrip:c}=this.props;return Object(g.jsxs)("main",{className:"home-page main",children:[Object(g.jsx)(ge,{loadStays:i,addTrip:c}),Object(g.jsx)("h1",{children:"Popular destinations"}),Object(g.jsx)(Oe,{onSearch:t}),Object(g.jsxs)("div",{className:"filter-gallery-header",children:[Object(g.jsx)("h1",{children:"Explore nearby"}),Object(g.jsx)(l.b,{to:"/explore",onClick:this.explorAll,children:"Show more"})]}),Object(g.jsx)(be,{stays:a,addTrip:c}),Object(g.jsx)(ue,{name:"banner-top",btnTxt:"Get inspired",title:"The Gearest Outdoors",subtitle:"Wishlists curated by Airbnb."}),Object(g.jsxs)("div",{className:"filter-gallery-header",children:[Object(g.jsx)("h1",{children:"Top Rated"}),Object(g.jsx)(l.b,{to:"/explore",onClick:this.explorAll,children:"Show more"})]}),Object(g.jsx)(be,{stays:s,addTrip:c}),Object(g.jsx)(ue,{name:"banner-bottom",btnTxt:"Learn more",title:"Become a host",subtitle:"earn extra income and unlock new opportunities by sharing your space.",loggedInUser:e})]})}}class ye extends a.Component{constructor(){super(...arguments),this.state={trip:{guests:{adults:1,kids:0},loc:{address:"",stay:null},time:{checkIn:"",checkOut:""}},topRatedStays:[],dynamicModal:{modalContent:"",modalPosition:{top:0,left:0,height:0}}},this.onSetModal=(e,t)=>{const s={x:e.pageX,y:e.pageY};this.setState({dynamicModal:{...this.state.dynamicModal,modalPosition:s}},(()=>{this.openModal(t)}))},this.handleDates=e=>{var t=e.startDate.toDateString(),s=e.endDate.toDateString();this.setState({trip:{...this.state.trip,time:{checkIn:t,checkOut:s}}})},this.openModal=e=>{const t={},{x:s,y:a}=this.state.dynamicModal.modalPosition;switch(e){case"date":t.modalContent=Object(g.jsx)("section",{className:"dynamic-modal-child book-date-modal",children:Object(g.jsx)(C,{handleDates:this.handleDates})}),t.modalPosition={top:a+35,left:s};break;case"loc":t.modalContent=Object(g.jsx)("section",{className:"dynamic-modal-child filter-loc-modal",children:k.getTopCities().map((e=>Object(g.jsxs)("div",{onClick:()=>{this.handleChange({target:{name:"address",type:"search",value:"".concat(e.city)}})},className:"modal-label",children:[Object(g.jsx)("img",{src:e.imgUrl,alt:"city"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:e.city}),Object(g.jsx)("span",{children:e.state})]})]},Math.random())))}),t.modalPosition={top:a+35,left:s};break;case"guests":const{kids:e,adults:i}=this.state.trip.guests;t.modalContent=Object(g.jsxs)("section",{className:"dynamic-modal-child filter-guest-modal",children:[Object(g.jsxs)("div",{className:"modal-label",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:"Adults"}),Object(g.jsx)("span",{children:"Ages 13 or above"})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{type:"button",onClick:()=>{this.handleChange({target:{name:"adults",type:"number",value:i-1}})},children:"-"}),Object(g.jsx)("span",{children:i}),Object(g.jsx)("button",{type:"button",onClick:()=>{this.handleChange({target:{name:"adults",type:"number",value:i+1}})},children:"+"})]})]}),Object(g.jsxs)("div",{className:"modal-label",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:"Kids"}),Object(g.jsx)("span",{children:"Ages 2\u201312"})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{type:"button",onClick:()=>{this.handleChange({target:{name:"kids",type:"number",value:e-1}})},children:"-"}),Object(g.jsx)("span",{children:e}),Object(g.jsx)("button",{type:"button",onClick:()=>{this.handleChange({target:{name:"kids",type:"number",value:e+1}})},children:"+"})]})]})]}),t.modalPosition={top:a+35,left:s};break;case"":t.modalContent="",t.modalPosition={top:0,left:0,height:0}}this.props.setModalContent(t,e)},this.loadTrip=()=>{var e=this.props.trip;e||(e={guests:{adults:1,kids:0},loc:{address:"",stay:null},time:{checkIn:"",checkOut:""}}),this.setState({trip:e})},this.handleChange=e=>{e.timeStamp&&e.preventDefault();const{name:t,value:s,type:a}=e.target;if("date"===a)this.setState({trip:{...this.state.trip,time:{...this.state.trip.time,[t]:s}}});else if("number"===a){if(s<0)return;this.setState({trip:{...this.state.trip,guests:{...this.state.trip.guests,[t]:+s}}},(()=>{this.openModal("guests")}))}else this.setState({trip:{...this.state.trip,loc:{...this.state.trip.loc,[t]:s}}})},this.onSearch=e=>{e.preventDefault(),this.props.onSearch(this.state.trip),this.onSetModal(e,"")},this.loadRated=async()=>{const e=await m.getTopRatedStays();this.setState({topRatedStays:e})},this.handle=()=>{}}componentDidMount(){this.loadRated(),this.loadTrip()}componentDidUpdate(e){e.trip!==this.props.trip&&this.loadTrip(),e.modalType!==this.props.modalType&&this.openModal(this.props.modalType)}render(){const{isFullHeader:e,openFullHeader:t}=this.props,{loc:s,time:a,guests:i}=this.state.trip,{address:c}=s,{checkIn:n,checkOut:o}=a,{kids:r,adults:d}=i;return Object(g.jsxs)("section",{className:"main-filter-container",children:[Object(g.jsxs)("form",{className:e?"max-filter":"filter-close",children:[Object(g.jsxs)("label",{children:[Object(g.jsx)("span",{children:"Location"}),Object(g.jsx)("input",{onClick:e=>this.onSetModal(e,"loc"),name:"address",value:c,autoComplete:"off",id:"location",type:"search",placeholder:"Where are you going?",onChange:this.handleChange})]}),Object(g.jsxs)("label",{htmlFor:"check-in",children:[Object(g.jsx)("span",{children:"Check in"}),Object(g.jsx)("input",{value:n,id:"check-in",autoComplete:"off",placeholder:"Add dates",onClick:e=>this.onSetModal(e,"date"),onChange:this.handle})]}),Object(g.jsxs)("label",{htmlFor:"check-out",children:[Object(g.jsx)("span",{children:"Check out"}),Object(g.jsx)("input",{value:o,id:"check-out",autoComplete:"off",placeholder:"Add dates",onClick:e=>this.onSetModal(e,"date"),onChange:this.handle})]}),Object(g.jsx)("label",{className:"guests",htmlFor:"guests",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:"Guests"}),Object(g.jsx)("input",{onClick:e=>{this.onSetModal(e,"guests")},value:r+d+"  guests",id:"guests",name:"guests",placeholder:"Add guests",onChange:this.handle})]})}),Object(g.jsx)("button",{onClick:this.onSearch,children:Object(g.jsx)(l.b,{to:"/explore",children:Object(g.jsx)("i",{className:"fas fa-search"})})})]}),Object(g.jsxs)("form",{className:e?"filter-close":"min-filter",onClick:t,children:[Object(g.jsx)("span",{children:c||"Start your search"}),Object(g.jsx)("button",{onClick:this.onSearch,children:Object(g.jsxs)(l.b,{to:"/explore",children:[Object(g.jsx)("i",{className:"fas fa-search"})," "]})})]})]})}}function ve(e){let{logout:t,toggleUserMenu:s,loggedInUser:a,modalPosition:i,isNewNotif:c}=e;return Object(g.jsxs)("section",{className:"user-menu",style:{top:i.y+40,left:i.x},onClick:s,children:[!a&&Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{children:Object(g.jsx)(l.b,{to:"/login",children:"log in"})}),Object(g.jsxs)("div",{children:[Object(g.jsx)(l.b,{to:"/host",children:"Host your home"}),Object(g.jsx)(l.b,{to:"/about",children:"about"}),Object(g.jsx)(l.b,{to:"/help",children:"help"})]})]}),a&&Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(l.b,{to:"/",children:"Messages"}),!c&&Object(g.jsx)(l.b,{className:"notif",to:"/notif",children:"Notifications"}),c&&Object(g.jsxs)(l.b,{className:"notif",to:"/notif",children:[Object(g.jsx)("p",{children:"Notifications"}),Object(g.jsx)("div",{className:"notif-circle"})]}),Object(g.jsx)(l.b,{to:"/orders",children:"Trips"}),Object(g.jsx)(l.b,{to:"/wishlist",children:"wish list"}),a.isHost&&Object(g.jsx)(l.b,{to:"/host/".concat(a._id),children:"Dashboard"}),!a.isHost&&Object(g.jsx)(l.b,{to:"/host",children:"Host your home"})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)(l.b,{to:"/user",children:"account"}),Object(g.jsx)(l.b,{to:"/help",children:"help"}),Object(g.jsxs)(l.b,{to:"/",children:[" ",Object(g.jsx)("button",{onClick:()=>{t()},children:"logout"})," "]})]})]})]})}class fe extends i.a.Component{constructor(){super(...arguments),this.state={isFullHeader:!0,isWindowTop:!0,isHomePage:!1,modalPosition:{x:0,y:0},isNarrow:!1,isDetailsHeader:!1},this.openDetailsHeader=()=>{window.scrollY>1500?this.setState({isDetailsHeader:!0}):this.setState({isDetailsHeader:!1})},this.explorAll=async()=>{await this.props.addTrip({guests:{adults:1,kids:0},loc:{address:""},time:{checkIn:"",checkOut:""}}),this.props.loadStays()},this.toggleUserMenu=e=>{const t=e.target.getBoundingClientRect();this.setState({modalPosition:t}),this.props.openDynamicModal("user-menu",e)},this.closeFullHeader=e=>{e.target.closest(".main-filter-container")||e.target.closest(".dynamic-modal-child")||this.setState({isFullHeader:!1},(()=>{window.removeEventListener("click",this.closeFullHeader,!0)}))},this.openFullHeader=()=>{this.setState({isFullHeader:!0},(()=>{window.addEventListener("click",this.closeFullHeader,!0)}))},this.getScrollPos=()=>{window.scrollY<100?this.setState({isWindowTop:!0,isFullHeader:!0}):this.setState({isWindowTop:!1,isFullHeader:!1})},this.scrollTo=e=>{window.scrollTo({top:e,left:0,behavior:"smooth"})},this.getAvgRate=e=>{const t=e.reviews.map((e=>e.avgRate)),s=t.reduce(((e,t)=>e+=t),0);return 0===s?"new":(s/t.length).toFixed(1)}}componentDidMount(){this.setCurrPage()}componentDidUpdate(e){e.currPage!==this.props.currPage&&this.setCurrPage()}setCurrPage(){"home"===this.props.currPage?(window.addEventListener("scroll",this.getScrollPos,!0),window.removeEventListener("scroll",this.openDetailsHeader,!0),this.setState({isHomePage:!0,isFullHeader:!0,isWindowTop:!0,isNarrow:!1,isDetailsHeader:!1})):"stay"===this.props.currPage?(window.addEventListener("scroll",this.openDetailsHeader,!0),window.removeEventListener("scroll",this.getScrollPos,!0),this.setState({isHomePage:!1,isFullHeader:!1,isWindowTop:!1,isNarrow:!0})):(window.removeEventListener("scroll",this.getScrollPos,!0),window.removeEventListener("scroll",this.openDetailsHeader,!0),this.setState({isHomePage:!1,isFullHeader:!1,isWindowTop:!1,isNarrow:!1,isDetailsHeader:!1}))}render(){const{onSearch:e,loggedInUser:t,logout:s,trip:a,openDynamicModal:i,modalType:c,setModalContent:n,isNewNotif:o}=this.props,{isFullHeader:r,isWindowTop:d,modalPosition:h,isNarrow:j,isDetailsHeader:p}=this.state,m=t?t.imgUrl:f;return Object(g.jsxs)("header",{className:"main-header ".concat(r&&"full-header"," ").concat(d&&"full-header top"," ").concat(j?"narrow-header":"wide-header"," ").concat(p&&"details-header"),children:[Object(g.jsxs)("section",{className:"details-header-nav",children:[Object(g.jsxs)("div",{className:"details-nav",children:[Object(g.jsx)("span",{onClick:()=>{this.scrollTo(0)},children:"Photos"}),Object(g.jsx)("span",{onClick:()=>{this.scrollTo(1210)},children:"Amenities"}),Object(g.jsx)("span",{onClick:()=>{this.scrollTo(1580)},children:"Reviews"}),Object(g.jsx)("span",{onClick:()=>{this.scrollTo(2100)},children:"Location"})]}),Object(g.jsxs)("div",{className:"book-stay-mini",children:[Object(g.jsxs)("div",{children:[Object(g.jsxs)("h3",{children:[Object(g.jsxs)("span",{children:["$ ",a&&a.stay&&a.stay.price?a.stay.price.toLocaleString("en-US"):0]})," / night"]}),Object(g.jsxs)("h4",{children:[Object(g.jsx)("i",{className:"fas fa-star"}),a&&a.stay&&a.stay.reviews?this.getAvgRate(a.stay):""," ",Object(g.jsxs)("span",{children:["( ",a&&a.stay&&a.stay.reviews?a.stay.reviews.length+" reviews":"new"," )"]})]})]}),Object(g.jsxs)("section",{className:"book-stay-btn-container",onClick:()=>{this.scrollTo(650)},children:[Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"cell"}),Object(g.jsx)("div",{className:"content",children:Object(g.jsx)("button",{className:"square",children:Object(g.jsx)("p",{children:"Check availability"})})})]})]})]}),Object(g.jsxs)("section",{children:[Object(g.jsx)(l.c,{className:"logo-link",to:"/",children:Object(g.jsxs)("h1",{className:"logo",children:["Home",Object(g.jsx)("i",{className:"fab fa-airbnb"}),"Go"]})}),Object(g.jsx)(l.c,{className:"mini-logo-link",to:"/",children:Object(g.jsx)("i",{className:"fab fa-airbnb"})}),Object(g.jsxs)("nav",{children:[Object(g.jsx)(l.b,{to:t?"/host/".concat(t._id):"/host",children:"Become a host"}),Object(g.jsx)(l.c,{to:"/explore",onClick:this.explorAll,children:"Explore"}),Object(g.jsxs)("button",{onClick:this.toggleUserMenu,className:"user-menu-btn",children:[Object(g.jsx)("span",{children:Object(g.jsx)("i",{className:"fas fa-bars"})}),Object(g.jsx)("img",{src:m,alt:"avatar"}),o&&Object(g.jsx)("div",{className:"notif-circle"})]})]}),"user-menu"===c&&Object(g.jsx)(ve,{logout:s,loggedInUser:t,toggleUserMenu:this.toggleUserMenu,modalPosition:h,isNewNotif:o})]}),Object(g.jsx)(ye,{trip:a,modalType:c,onSearch:e,openDynamicModal:i,isFullHeader:r,openFullHeader:this.openFullHeader,toggleFullHeader:this.toggleFullHeader,setModalContent:n})]})}}function Ne(e){let{onSearch:t,topRatedStays:s,nearbayStays:a}=e;const i=k.getTopCities();return Object(g.jsxs)("section",{className:"footer-links-container",children:[Object(g.jsx)("h3",{children:"Inspiration for future getaways"}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"Top Rated"}),s.map((e=>Object(g.jsxs)(l.b,{to:"/stay/".concat(e._id),children:[Object(g.jsx)("span",{children:e.name}),Object(g.jsx)("span",{children:e.loc.address})]},Math.random())))]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"Nearby"}),a.map((e=>Object(g.jsxs)(l.b,{to:"/stay/".concat(e._id),children:[Object(g.jsx)("span",{children:e.name}),Object(g.jsx)("span",{children:e.loc.address})]},Math.random())))]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"Cities"}),i.map((e=>Object(g.jsxs)(l.b,{to:"/explore",onClick:()=>{var s;s="".concat(e.city),t({guests:{adults:1,kids:0},loc:{address:s},time:{checkIn:"",checkOut:""}}),window.scroll({top:0})},children:[Object(g.jsx)("span",{children:e.city}),Object(g.jsx)("span",{children:e.state})]},Math.random())))]})]})]})}function Se(e){let{onSearch:t,topRatedStays:s,nearbayStays:a}=e;return Object(g.jsx)("footer",{className:"main-footer full",children:Object(g.jsxs)("section",{children:[Object(g.jsx)(Ne,{onSearch:t,topRatedStays:s,nearbayStays:a}),Object(g.jsxs)("section",{className:"footer-nav-container",children:[Object(g.jsxs)("div",{children:[Object(g.jsxs)("p",{children:["\xa9 2021 Home & Go, ",Object(g.jsx)("span",{children:"Inc."})]}),Object(g.jsx)("span",{children:"\xb7"}),Object(g.jsx)(l.b,{to:"/about",children:"About"}),Object(g.jsx)("span",{children:"\xb7"}),Object(g.jsx)(l.b,{to:"/login",children:"Login"}),Object(g.jsx)("span",{children:"\xb7"}),Object(g.jsx)(l.b,{to:"/host",children:"Become a host"})]}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("p",{children:[Object(g.jsx)("i",{className:"fas fa-globe"}),Object(g.jsx)("span",{children:"English (US)"}),Object(g.jsx)("span",{children:"$ US"})]}),Object(g.jsxs)("p",{children:[Object(g.jsx)("i",{className:"fab fa-facebook-f"}),Object(g.jsx)("i",{className:"fab fa-twitter"}),Object(g.jsx)("i",{className:"fab fa-instagram"})]})]})]})]})})}function we(e){let{onSelectAction:t}=e;return Object(g.jsxs)("div",{className:"dash-nav-container",children:[Object(g.jsxs)("button",{className:"add-stay-btn",value:"add stay",onClick:t,children:[Object(g.jsx)("i",{className:"fas fa-plus"}),"Add Stay"]}),Object(g.jsxs)("button",{value:"my Stays",onClick:t,children:[Object(g.jsx)("i",{className:"fas fa-house-user"}),"My Stays"]}),Object(g.jsxs)("button",{value:"orders",onClick:t,children:[Object(g.jsx)("i",{className:"fas fa-clipboard-list"}),"Orders"]}),Object(g.jsxs)("button",{value:"rate stat",onClick:t,children:[Object(g.jsx)("i",{className:"fas fa-star"}),"Rates"]})]})}function Ce(e){let{stays:t,orders:s,orderChangeStatus:a}=e;function i(e){var t=0;return s.forEach((s=>{s.status===e&&t++})),t}function c(){const e=[],t=new Date(Date.now());return s.forEach((s=>{const a=new Date(s.startDate),i=new Date(s.endDate);a<t&&i>t&&e.push(s)})),e}return Object(g.jsxs)("section",{className:"dash-header",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:"Total Rate"}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"fas fa-star"}),function(){var e=0;return t.forEach((t=>{const s=t.reviews.map((e=>e.avgRate));var a=s.reduce(((e,t)=>e+t),0);e+=a/s.length})),e/t.length?(e/t.length).toFixed(1):0}()]}),Object(g.jsxs)("p",{children:[a,"%",Object(g.jsx)("i",{className:"fas fa-long-arrow-alt-up"})]})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:"monthly earning"}),Object(g.jsx)("div",{children:Object(g.jsxs)("span",{children:["$ ",function(){var e=0;const t=new Date(Date.now()).getMonth()+1,a=new Date(Date.now()).getFullYear();return s.forEach((s=>{const i=new Date(s.startDate).getMonth()+1,c=new Date(s.startDate).getFullYear();t===i&&a===c&&(e+=s.totalPrice)})),e.toLocaleString("en-US")}()]})})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:"Orders"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:s.length}),Object(g.jsxs)("div",{className:"circle-container",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{title:"pending",className:"circle circle-yellow"}),Object(g.jsx)("p",{children:i("wait for approval")})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{title:"approved",className:"circle circle-green"}),Object(g.jsx)("p",{children:i("approved")})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{title:"decline",className:"circle circle-red"}),Object(g.jsx)("p",{children:i("declined")})]})]})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:"Active Guests"}),Object(g.jsx)("span",{children:c().length})]}),Object(g.jsx)("div",{children:c().map((e=>Object(g.jsx)("img",{src:e.user.imgUrl,alt:"guest"},Math.random())))})]})]})}function ke(e){let{stay:t,onSelectedEditStay:s}=e;return Object(g.jsxs)("div",{className:"host-stay-preview",children:[Object(g.jsx)("span",{children:Object(g.jsx)("img",{src:t.imgUrls[0],alt:"stay"})}),Object(g.jsx)("span",{children:Object(g.jsx)(l.b,{to:"/stay/".concat(t._id),children:t.name})}),Object(g.jsx)("span",{children:Object(g.jsx)(l.b,{to:"/stay/".concat(t._id),children:t.loc.address})}),Object(g.jsx)("span",{children:Object(g.jsxs)(l.b,{to:"/stay/".concat(t._id),children:["$ ",t.price]})}),Object(g.jsx)("span",{className:"stay-actions",children:Object(g.jsxs)("button",{onClick:()=>s(t),children:[Object(g.jsx)("i",{className:"far fa-edit"}),"Edit"]})})]})}function Ue(e){let{stays:t,onSelectedEditStay:s,onSelectAction:a}=e;return Object(g.jsx)("section",{className:"host-stay-list",children:Object(g.jsxs)("div",{className:"host-stay-list-table",children:[Object(g.jsx)("div",{className:"thead",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:""}),Object(g.jsx)("span",{children:"Name"}),Object(g.jsx)("span",{children:"Address"}),Object(g.jsx)("span",{children:"Price"}),Object(g.jsx)("span",{className:"stay-actions",children:"Actions"})]})}),Object(g.jsxs)("div",{className:"tbody",children:[!t.length&&Object(g.jsxs)("h1",{className:"empty-msg",children:["No Stays to show yet, you can add new stay on the ",Object(g.jsx)("button",{value:"add stay",onClick:a,children:"Add Stay "})," tab"]}),t.length>0&&t.map((e=>Object(g.jsx)(ke,{stay:e,onSelectedEditStay:s},Math.random())))]})]})})}function Te(e){let{stays:t,onSelectedEditStay:s,onSelectAction:a}=e;return t?Object(g.jsx)("section",{className:"host-stay-container",children:Object(g.jsx)(Ue,{stays:t,onSelectedEditStay:s,onSelectAction:a})}):Object(g.jsx)(Q,{})}function Me(e){let{stays:t,updateSelectedStay:s}=e;return Object(g.jsx)("section",{className:"host-rate-card",children:t.map((e=>Object(g.jsxs)("label",{onClick:()=>{s(e)},children:[Object(g.jsx)("img",{src:e.imgUrls[0],alt:"stay-preview"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:e.name}),Object(g.jsx)("h6",{children:"".concat(e.loc.address)}),Object(g.jsx)("h6",{children:"".concat(e.capacity," Guests")})]})]},Math.random())))})}var De=s(161);function Ie(e){let{stay:t}=e;const s={labels:["1 Star","2 Star","3 Star","4 Star","5 Star"],datasets:[{label:"# of Votes",data:t.reviews.reduce(((e,t)=>(e[Math.round(t.avgRate)-1]++,e)),[0,0,0,0,0]),backgroundColor:["rgba(255, 61, 61, 0.5)","rgba(255, 163, 59, 0.5)","rgba(252, 255, 71, 0.5)","rgba(184, 255, 103, 0.5)","rgba(66, 245, 110, 0.5)"],borderColor:["rgba(255, 61, 61, 0.8)","rgba(255, 163, 59, 0.8)","rgba(252, 255, 71, 0.8)","rgba(184, 255, 103, 0.5)","rgba(66, 245, 110, 0.8)"],borderWidth:1}]};return Object(g.jsx)("div",{className:"rate-chart",children:Object(g.jsx)(De.a,{data:s})})}class Ae extends a.Component{constructor(){super(...arguments),this.state={stay:null},this.updateSelectedStay=e=>{this.setState({stay:e})}}componentDidMount(){this.setState({stay:this.props.stays[0]})}render(){const{stays:e}=this.props,{stay:t}=this.state;return Object(g.jsx)("section",{className:"dash-rate-statistics-container",children:Object(g.jsxs)("div",{className:"dash-rate-statistics",children:[Object(g.jsx)(Me,{stays:e,updateSelectedStay:this.updateSelectedStay}),t&&Object(g.jsxs)("div",{className:"chart-container",children:[Object(g.jsx)("h3",{children:t.name}),Object(g.jsx)(Ie,{stay:t})]})]})})}}function _e(e){return async t=>{try{t({type:"UPDATE_STAY",stay:await m.update(e)})}catch(s){console.log("StayActions: err in update Stay",s)}}}function Pe(e){return async t=>{try{await m.remove(e),t({type:"REMOVE_STAY",stayId:e})}catch(s){console.log("StayActions: err in removeStay",s)}}}function Ee(e){return async t=>{try{t({type:"SET_HOST_STAYS",stays:await m.getHostStays(e)})}catch(s){console.log("StayActions: err in loadHostStays",s)}}}const Re={uploadImg:function(e){const t="https://api.cloudinary.com/v1_1/".concat("home-to-go","/image/upload"),s=new FormData;return s.append("file",e.target.files[0]),s.append("upload_preset","aui0olgm"),fetch(t,{method:"POST",body:s}).then((e=>e.json())).then((e=>e)).catch((e=>console.error(e)))}};class Fe extends a.Component{constructor(){super(...arguments),this.state={imgUrl:null,height:60,width:60,isUploading:!1},this.uploadImg=async e=>{this.setState({isUploading:!0});const{secure_url:t,height:s,width:a}=await Re.uploadImg(e);this.setState({isUploading:!1,imgUrl:t,height:s,width:a},(()=>{this.props.onUploadImg(this.state,this.props.position)}))}}componentDidMount(){const{userImgUrl:e}=this.props;e&&this.setState({imgUrl:e})}get uploadMsg(){const{imgUrl:e,isUploading:t}=this.state;return e?"Upload Another?":t?"Uploading....":"Upload Image"}render(){const{imgUrl:e}=this.state,t={backgroundImage:"url(".concat(e,")")};return Object(g.jsx)("div",{className:"upload-preview",style:t,children:Object(g.jsxs)("label",{className:"img-upload-label",htmlFor:"imgUpload",children:[this.uploadMsg,Object(g.jsx)("input",{type:"file",onChange:this.uploadImg,accept:"img/*",className:"img-upload-btn",id:"imgUpload"})]})})}}class He extends a.Component{constructor(){super(...arguments),this.state={stay:{name:"",imgUrls:[],price:"",desc:"",capacity:"",amenities:{TV:!0,Wifi:!1,"Air conditioning":!1,"Smoking allowed":!1,"Pets allowed":!1,"Cooking basics":!1},stayType:"entire place",propertyType:"appartment",host:{_id:this.props.loggedInUser._id,fullname:this.props.loggedInUser.fullname,imgUrl:this.props.loggedInUser.imgUrl},loc:{country:"",countryCode:"",address:"",lat:0,lng:0},reviews:[]}},this.onRemoveStays=async(e,t)=>{e.target.value="my Stays",await this.props.removeStay(t),this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"far fa-check-circle"}),Object(g.jsx)("h3",{children:"Your stay has been deleted"})]})),this.props.onSelectAction(e)},this.onUploadImg=(e,t)=>{const s=this.state.stay.imgUrls;s[t]=e.imgUrl,this.setState({stay:{...this.state.stay,imgUrls:s}})},this.handleChange=e=>{let{target:t}=e,{name:s,value:a,id:i,checked:c}=t;a="price"===s||"capacity"===s?+a:a,"amenities"===s?this.setState({stay:{...this.state.stay,amenities:{...this.state.stay.amenities,[i]:c}}}):"address"===s?this.setState({stay:{...this.state.stay,loc:{...this.state.stay.loc,[s]:a}}}):this.setState({stay:{...this.state.stay,[s]:a}})},this.onSaveStay=e=>{e.preventDefault(),e.target.value="my Stays";const{stay:t}=this.state,{amenities:s}=t,a=[];for(const i in s)s[i]&&a.push(i);t.amenities=a,t._id?(this.props.updateStay(t),this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"far fa-check-circle"}),Object(g.jsx)("h3",{children:"Your stay has been updated"})]}))):(this.props.addStay(t),this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"far fa-check-circle"}),Object(g.jsx)("h3",{children:"Your stay has been added"})]}))),this.props.onSelectAction(e)},this.getTotalRate=()=>{const e=this.state.stay.reviews.map((e=>e.avgRate)),t=e.reduce(((e,t)=>e+=t),0);return 0===t?"new":(t/e.length).toFixed(2)}}componentDidMount(){if(this.props.stayEdit){const e={};this.props.stayEdit.amenities.forEach((t=>{e[t]=!0})),this.setState({stay:{...this.props.stayEdit,amenities:e}})}else this.loadStay()}loadStay(){if(!this.props.match||!this.props.match.params)return;const{stayId:e}=this.props.match.params;e&&m.getById(e).then((e=>{this.setState({stay:e})}))}render(){const{stay:e}=this.state;return this.props.stayEdit&&!e.imgUrls[0]?"":e?Object(g.jsx)("section",{className:"stay-edit-container",children:Object(g.jsxs)("form",{className:"stay-edit-form",onSubmit:this.onSaveStay,children:[Object(g.jsxs)("section",{className:"stay-edit-header",children:[Object(g.jsxs)("div",{className:"stay-edit-header-name",children:[Object(g.jsx)("h1",{children:Object(g.jsx)("input",{type:"text",name:"name",autoComplete:"off",onChange:this.handleChange,value:e.name,placeholder:"stay name",required:!0})}),this.props.stayEdit&&Object(g.jsxs)("button",{type:"button",className:"remove-btn",onClick:e=>this.onRemoveStays(e,this.props.stayEdit._id),children:[Object(g.jsx)("i",{className:"far fa-trash-alt"}),"Remove"]})]}),Object(g.jsxs)("div",{className:"stay-edit-short-info",children:[Object(g.jsxs)("div",{children:[Object(g.jsxs)("span",{className:"stay-rate-display",children:[Object(g.jsx)("i",{className:"fas fa-star"}),Object(g.jsx)("span",{children:this.getTotalRate()}),Object(g.jsxs)("p",{children:[" ( ",e.reviews.length," reviews )"]})]}),Object(g.jsx)("span",{children:"\u2022"}),Object(g.jsxs)("p",{children:["Address:",Object(g.jsx)("input",{type:"text",name:"address",autoComplete:"off",onChange:this.handleChange,value:e.loc.address,required:!0})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{type:"button",children:Object(g.jsxs)("p",{children:[Object(g.jsx)("i",{className:"fas fa-external-link-alt"}),"share"]})}),Object(g.jsx)("button",{type:"button",className:"stay-save-btn",children:Object(g.jsxs)("p",{children:[Object(g.jsx)("i",{className:"far fa-heart"}),"save"]})})]})]})]}),Object(g.jsxs)("div",{className:"stay-gallery",children:[Object(g.jsx)(Fe,{userImgUrl:e.imgUrls[0],onUploadImg:this.onUploadImg,position:0}),Object(g.jsx)(Fe,{userImgUrl:e.imgUrls[1],onUploadImg:this.onUploadImg,position:1}),Object(g.jsx)(Fe,{userImgUrl:e.imgUrls[2],onUploadImg:this.onUploadImg,position:2}),Object(g.jsx)(Fe,{userImgUrl:e.imgUrls[3],onUploadImg:this.onUploadImg,position:3}),Object(g.jsx)(Fe,{userImgUrl:e.imgUrls[4],onUploadImg:this.onUploadImg,position:4})]}),Object(g.jsxs)("section",{className:"stay-edit-info-container",children:[Object(g.jsxs)("div",{className:"stay-edit-long-info",children:[Object(g.jsxs)("div",{className:"stay-long-info-header",children:[Object(g.jsx)("div",{className:"stay-long-info-header-txt",children:Object(g.jsxs)("span",{children:["capacity:",Object(g.jsx)("input",{className:"capacity",type:"number",name:"capacity",autoComplete:"off",onChange:this.handleChange,value:e.capacity,required:!0}),"\u2022 stayType:",Object(g.jsxs)("select",{name:"stayType",onChange:this.handleChange,children:[Object(g.jsx)("option",{value:"entire place",children:"entire place"}),Object(g.jsx)("option",{value:"private room",children:"private room"})]}),"\u2022 propertyType:",Object(g.jsxs)("select",{name:"propertyType",onChange:this.handleChange,value:e.propertyType,children:[Object(g.jsx)("option",{value:"loft",children:"loft"}),Object(g.jsx)("option",{value:"room",children:"room"}),Object(g.jsx)("option",{value:"studio",children:"studio"}),Object(g.jsx)("option",{value:"villa",children:"villa"}),Object(g.jsx)("option",{value:"appartment",children:"appartment"})]})]})}),Object(g.jsx)("img",{src:e.host.imgUrl,alt:"avatar"})]}),Object(g.jsxs)("div",{className:"stay-feature-container",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("i",{className:"fas fa-home"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:e.stayType}),Object(g.jsx)("h4",{children:"entire place"===e.stayType?"You'll have the place to yourself.":"You'll have a private room to yourself."})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("i",{className:"fas fa-book-open"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:"House rules"}),Object(g.jsx)("h4",{children:"This place isn\u2019t suitable for children under 12 and the host doesn\u2019t allow pets."})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("i",{className:"fas fa-medal"}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("h3",{children:[e.host.fullname," is a Superhost"]}),Object(g.jsx)("h4",{children:"Superhosts are experienced, highly rated hosts who are committed to providing great stays for guests."})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("i",{className:"fas fa-bookmark"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:"Wifi"}),Object(g.jsx)("h4",{children:"Guests often search for this popular amenity"})]})]})]}),Object(g.jsxs)("span",{className:"description",children:[Object(g.jsx)("h2",{children:"description"}),Object(g.jsx)("textarea",{type:"text",name:"desc",autoComplete:"off",onChange:this.handleChange,value:e.desc,required:!0})]}),Object(g.jsxs)("div",{className:"amenities-list",children:[Object(g.jsx)("h2",{children:"Amenities"}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("span",{children:[Object(g.jsx)("input",{type:"checkbox",id:"TV",name:"amenities",value:e.amenities.TV,checked:e.amenities.TV,onChange:this.handleChange}),Object(g.jsx)("label",{htmlFor:"TV",children:" TV"})]}),Object(g.jsxs)("span",{children:[Object(g.jsx)("input",{type:"checkbox",id:"Wifi",name:"amenities",value:e.amenities.Wifi,checked:e.amenities.Wifi,onChange:this.handleChange}),Object(g.jsx)("label",{htmlFor:"Wifi",children:"Wifi"})]}),Object(g.jsxs)("span",{children:[Object(g.jsx)("input",{type:"checkbox",id:"Air conditioning",name:"amenities",value:e.amenities["Air conditioning"],checked:e.amenities["Air conditioning"],onChange:this.handleChange}),Object(g.jsx)("label",{htmlFor:"Air conditioning",children:"AC "})]}),Object(g.jsxs)("span",{children:[Object(g.jsx)("input",{type:"checkbox",id:"Smoking allowed",name:"amenities",value:e.amenities["Smoking allowed"],checked:e.amenities["Smoking allowed"],onChange:this.handleChange}),Object(g.jsx)("label",{htmlFor:"Smoking_allowed",children:"Smoking allowed "})]}),Object(g.jsxs)("span",{children:[Object(g.jsx)("input",{type:"checkbox",id:"Pets allowed",name:"amenities",value:e.amenities["Pets allowed"],checked:e.amenities["Pets allowed"],onChange:this.handleChange}),Object(g.jsx)("label",{htmlFor:"Pets allowed",children:"Pets allowed "})]}),Object(g.jsxs)("span",{children:[Object(g.jsx)("input",{type:"checkbox",id:"Cooking basics",name:"amenities",value:e.amenities["Cooking basics"],checked:e.amenities["Cooking basics"],onChange:this.handleChange}),Object(g.jsx)("label",{htmlFor:"Cooking basics",children:"Cooking basics "})]})]})]})]}),Object(g.jsx)("div",{className:"order-form-container",children:Object(g.jsxs)("h3",{children:["price:"," ",Object(g.jsx)("input",{type:"number",name:"price",autoComplete:"off",onChange:this.handleChange,value:e.price})," ","/ night"]})})]}),Object(g.jsx)("button",{type:"submit",className:"stay-edit-save-btn",children:"Save"})]})}):""}}const Le={addStay:function(e){return async t=>{try{t({type:"ADD_STAY",stay:await m.add(e)})}catch(s){console.log("StayActions: err in addStay",s)}}},updateStay:_e},We=Object(S.b)((function(e){return{stays:e.stayModule.stays}}),Le)(He);function qe(e){let{order:t,updateOrder:s}=e;function a(e){t.status=e,s(t)}return Object(g.jsxs)("div",{className:"host-stay-preview",children:[Object(g.jsx)("span",{children:Object(g.jsx)("img",{src:t.user.imgUrl,alt:"user"})}),Object(g.jsx)("span",{children:t.user.fullname}),Object(g.jsx)("span",{children:t.startDate}),Object(g.jsx)("span",{children:t.endDate}),Object(g.jsx)("span",{children:t.status}),Object(g.jsxs)("span",{children:["$ ",t.totalPrice.toLocaleString("en-US")]}),Object(g.jsxs)("span",{className:"stay-actions",children:["approved"===t.status&&Object(g.jsxs)("button",{onClick:()=>{a("declined")},children:[Object(g.jsx)("i",{className:"fas fa-times"}),"Decline"]}),"declined"===t.status&&Object(g.jsxs)("button",{onClick:()=>{a("approved")},children:[Object(g.jsx)("i",{className:"fas fa-check"}),"Re-Approve"]}),"wait for approval"===t.status&&Object(g.jsxs)("button",{onClick:()=>{a("approved")},children:[Object(g.jsx)("i",{className:"fas fa-check"}),"Approve"]})]})]})}function Be(e){let{orders:t,updateOrder:s,onSelectAction:a}=e;return Object(g.jsx)("section",{className:"host-order-list",children:Object(g.jsxs)("div",{className:"host-order-list-table",children:[Object(g.jsx)("div",{className:"thead",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:""}),Object(g.jsx)("span",{children:"Guest Name"}),Object(g.jsx)("span",{children:"Check in"}),Object(g.jsx)("span",{children:"Check out"}),Object(g.jsx)("span",{children:"Status"}),Object(g.jsx)("span",{children:"Price"}),Object(g.jsx)("span",{className:"stay-actions",children:"Actions"})]})}),Object(g.jsxs)("div",{className:"tbody",children:[!t.length&&Object(g.jsxs)("h1",{className:"empty-msg",children:["No Orders to show yet, you can edit your stay pages to make it more appealing on the ",Object(g.jsx)("button",{value:"my Stays",onClick:a,children:"My Stays"})," tab"]}),t.length>0&&t.map((e=>Object(g.jsx)(qe,{order:e,updateOrder:s},Math.random())))]})]})})}function Ye(e){let{orders:t,updateOrder:s,onSelectAction:a}=e;return Object(g.jsx)("section",{className:"host-order-container",children:Object(g.jsx)(Be,{orders:t,updateOrder:s,onSelectAction:a})})}var Ge=s.p+"static/media/user-cash.e1f91298.PNG";class Ve extends a.Component{constructor(){super(...arguments),this.state={action:"",loggedInUser:null,selsctedEditStay:null,orderChangeStatus:0},this.getRateChangStatus=()=>b.getRandomIntInclusive(0,5),this.loadHostStays=async()=>{await this.props.loadHostStays(this.state.loggedInUser._id),0===this.props.stays.length&&this.setState({action:"add stay"})},this.onSelectAction=async e=>{const t=e.target.value;this.setState({action:t})},this.onSelectedEditStay=e=>{this.setState({selsctedEditStay:e},(()=>{this.setState({action:"edit stay"})}))}}componentDidMount(){this.setState({loggedInUser:{...this.props.loggedInUser,isHost:!0}},(()=>{this.props.updateUser(this.state.loggedInUser),this.loadHostStays(),this.props.loadOrders({id:this.state.loggedInUser._id,type:"host"})})),this.props.setFooterDisplay(!1),this.props.setHomePage("dash"),this.setState({orderChangeStatus:b.getRandomIntInclusive(0,5)})}componentWillUnmount(e,t){this.props.setFooterDisplay(!0)}render(){const{action:e,loggedInUser:t,selsctedEditStay:s,orderChangeStatus:a}=this.state,{removeStay:i,stays:c,toggleMsgModal:n,orders:l,updateOrder:o}=this.props;return Object(g.jsx)("main",{className:"main page",children:Object(g.jsxs)("section",{className:"dashboard-container",children:[Object(g.jsxs)("section",{className:"dash-nav-sticky-container",children:[Object(g.jsx)(we,{onSelectAction:this.onSelectAction}),Object(g.jsxs)("div",{className:"host-info-container",children:[Object(g.jsx)("img",{src:Ge,alt:"cash"}),Object(g.jsx)("h2",{children:"Make all payments through Home & go"}),Object(g.jsx)("p",{children:"Always pay and communicate through Home & go to ensure you're protected under our Terms of Service, Payments Terms of Service, cancellation, and other safeguards."})]})]}),!c&&Object(g.jsx)(Q,{}),c&&Object(g.jsxs)("section",{className:"dash-main-container",children:[Object(g.jsx)(Ce,{stays:c,orders:l,orderChangeStatus:a}),Object(g.jsxs)("section",{className:"dash-info-container",children:[(""===e||"my Stays"===e)&&Object(g.jsx)(Te,{stays:c,onSelectedEditStay:this.onSelectedEditStay,onSelectAction:this.onSelectAction}),"rate stat"===e&&Object(g.jsx)(Ae,{stays:c}),"edit stay"===e&&Object(g.jsx)(We,{stayEdit:s,removeStay:i,onSelectAction:this.onSelectAction,loggedInUser:t,toggleMsgModal:n}),"add stay"===e&&Object(g.jsx)(We,{onSelectAction:this.onSelectAction,loggedInUser:t,toggleMsgModal:n}),"orders"===e&&Object(g.jsx)(Ye,{loggedInUser:t,orders:l,updateOrder:o,onSelectAction:this.onSelectAction})]})]})]})})}}const $e={loadHostStays:Ee,removeStay:Pe},Je=Object(S.b)((e=>({stays:e.stayModule.stays})),$e)(Ve);class ze extends a.Component{render(){const{order:e,getCancelationStatus:t,onCancelOrder:s}=this.props;return Object(g.jsxs)(l.b,{to:"/stay/".concat(e.stay._id),className:"order-preview",children:[Object(g.jsxs)("div",{className:"img-container",children:[Object(g.jsx)("img",{src:e.stay.imgUrls[0],alt:"stay"}),Object(g.jsx)("img",{src:e.stay.imgUrls[1],alt:"stay"}),Object(g.jsx)("img",{src:e.stay.imgUrls[2],alt:"stay"})]}),Object(g.jsxs)("div",{className:"details-container",children:[Object(g.jsxs)("h3",{children:[e.stay.name,Object(g.jsxs)("p",{children:[Object(g.jsx)("span",{children:e.startDate}),Object(g.jsx)("span",{children:e.endDate})]})]}),Object(g.jsxs)("h4",{className:"order-price",children:["$ ",e.totalPrice.toLocaleString("en-US")]}),Object(g.jsx)("h4",{className:"order-status ".concat("approved"===e.status&&"status-green"," ").concat("declined"===e.status&&"status-red"),children:e.status}),Object(g.jsxs)("div",{className:"order-cancelation",children:[Object(g.jsx)("h4",{children:t(e)}),"Non-refundable"!==t(e)&&Object(g.jsx)("button",{onClick:()=>s(e),children:"Cancel order"}),"Non-refundable"===t(e)&&Object(g.jsx)("button",{className:"cancel-disabled",disabled:!0,onClick:()=>s(e),children:"Cancel order"})]})]})]})}}function Ke(e){let{orders:t,getCancelationStatus:s,onCancelOrder:a}=e;return t&&t.length?Object(g.jsx)("section",{className:"order-list",children:t.map((e=>Object(g.jsx)(ze,{order:e,getCancelationStatus:s,onCancelOrder:a},Math.random())))}):Object(g.jsx)(Q,{})}class Xe extends a.Component{constructor(){super(...arguments),this.state={sction:"",loggedInUser:null,orders:[],filterBy:{status:!0,price:!0,checkIn:!0,checkOut:!0,name:!0},currPage:"upcoming"},this.loadOrders=async()=>{await this.props.loadOrders({id:this.state.loggedInUser._id,type:"user"}),this.setState({orders:this.props.orders}),this.showOrdersByTime()},this.onCancelOrder=async e=>{this.getTimeBeforeTrip(e.startDate)>=7?(await this.props.removeOrder(e._id),this.setState({orders:this.props.orders}),this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"far fa-check-circle"}),Object(g.jsx)("h3",{children:"Your order has been canceled"})]}))):this.props.toggleMsgModal(Object(g.jsxs)("span",{children:[Object(g.jsx)("i",{className:"far fa-times-circle"}),Object(g.jsx)("h3",{children:"You can't cancel this order"})]}))},this.toggleShowOrderTime=e=>{this.setState({currPage:e},(()=>{this.showOrdersByTime()}))},this.showOrdersByTime=()=>{const e=this.props.orders;var t=[];"upcoming"===this.state.currPage?e.forEach((e=>{new Date(e.startDate)-new Date(Date.now())>0&&t.push(e)})):e.forEach((e=>{new Date(e.startDate)-new Date(Date.now())<0&&t.push(e)})),this.setState({orders:t})},this.getCancelationStatus=e=>{var t=this.getTimeBeforeTrip(e.startDate)-7;return t>0?"Refundable in the next ".concat(t.toFixed(0)," days"):"Non-refundable"},this.getTimeBeforeTrip=e=>(new Date(e).getTime()-Date.now())/1e3/60/60/24,this.handleChange=e=>{var{name:t}=e.target;this.setState({filterBy:{...this.state.filterBy,[t]:!this.state.filterBy[t]}},(()=>{}))},this.onSortOrders=e=>{e.preventDefault();const t=this.state.orders;var s=[];switch(e.target.name){case"name":s=function(e){return e.sort((function(e,t){var s=e.stay.name.toUpperCase(),a=t.stay.name.toUpperCase();return s<a?-1:s>a?1:0}))}(t);break;case"checkIn":s=Ze(t,"startDate"),console.log(s);break;case"checkOut":s=Ze(t,"endDate");break;case"price":s=function(e){return e.sort((function(e,t){return e.totalPrice-t.totalPrice}))}(t)}this.setState({orders:s})}}componentDidMount(){this.setState({loggedInUser:this.props.loggedInUser},(()=>{this.loadOrders()})),this.props.setFooterDisplay(!1),this.props.setHomePage("orders")}componentWillUnmount(){this.props.setFooterDisplay(!0)}render(){const{orders:e,filterBy:t,currPage:s}=this.state,{name:a,price:i,status:c,checkIn:n,checkOut:l}=t;return console.log(e),e?Object(g.jsx)("main",{className:"user-order-container main page",children:Object(g.jsxs)("section",{className:"user-order-list",children:[Object(g.jsx)("h1",{children:"Trips"}),Object(g.jsxs)("div",{className:"order-header",children:[Object(g.jsxs)("div",{className:"order-nav",children:[Object(g.jsx)("button",{className:"upcoming"===s&&"active",onClick:()=>{this.toggleShowOrderTime("upcoming")},children:" Upcoming"}),Object(g.jsx)("button",{className:"past"===s&&"active",onClick:()=>{this.toggleShowOrderTime("past")},children:"Past"})]}),Object(g.jsxs)("div",{className:"order-filter",children:[Object(g.jsx)("button",{name:"name",value:a,onClick:this.onSortOrders,children:"Stay name"}),Object(g.jsx)("button",{name:"checkIn",value:n,onClick:this.onSortOrders,children:"Check in"}),Object(g.jsx)("button",{name:"checkOut",value:l,onClick:this.onSortOrders,children:"Check out"}),Object(g.jsx)("button",{name:"price",value:i,onClick:this.onSortOrders,children:"Price"}),Object(g.jsx)("button",{name:"status",value:c,children:"Status"})]})]}),Object(g.jsx)(Ke,{orders:e,getCancelationStatus:this.getCancelationStatus,onCancelOrder:this.onCancelOrder})]})}):Object(g.jsx)(Q,{})}}function Ze(e,t){return e.sort((function(e,s){return new Date(e[t])-new Date(s[t])}))}var Qe=s.p+"static/media/logo.b08875a0.png";class et extends a.Component{componentDidMount(){this.props.setFooterDisplay(!1)}componentWillUnmount(){this.props.setFooterDisplay(!0)}render(){const{loggedInUser:e}=this.props;return Object(g.jsx)("main",{className:"main",children:Object(g.jsxs)("section",{className:"full bocome-host-container",children:[Object(g.jsxs)("div",{className:"hosting-img",children:[Object(g.jsx)(l.b,{className:"a",to:"/",children:Object(g.jsx)("i",{className:"fab fa-airbnb fa-3x logo-icon"})}),Object(g.jsx)("img",{className:"guests-img",src:"https://www.insidehook.com/wp-content/uploads/2021/03/good-airbnb-guest-2.jpg?fit=1200%2C800",alt:""})]}),Object(g.jsxs)("div",{className:"hosting-info",children:[Object(g.jsx)("h1",{children:"Hosting makes us"}),Object(g.jsxs)("h1",{className:"logo",children:["Home",Object(g.jsx)("img",{src:Qe,alt:"logo"}),"Go"]})]}),Object(g.jsx)("button",{className:"host-btn",children:Object(g.jsx)(l.b,{to:e?"/host/".concat(e._id):"/login",children:"Try hosting"})})]})})}}class tt extends a.Component{constructor(){super(...arguments),this.onClearNotif=()=>{const e=this.props.loggedInUser;e.notifications=[],this.props.updateUser(e)}}async componentDidMount(){this.props.setFooterDisplay(!1),this.props.setHomePage("user"),this.props.setNotifStatus(!1)}async componentWillUnmount(){this.props.setFooterDisplay(!0)}render(){const{notifications:e}=this.props.loggedInUser;return Object(g.jsx)("main",{className:"notifications main page",children:Object(g.jsxs)("section",{className:"notif-list",children:[Object(g.jsx)("h1",{children:"Notifications"}),e&&e.map((e=>Object(g.jsxs)("div",{className:"notif-card",children:[Object(g.jsx)("img",{src:e.imgUrl,alt:"avatar"}),Object(g.jsxs)("span",{children:[Object(g.jsx)("h3",{children:e.fullname}),Object(g.jsx)("h4",{children:b.getTimeFormat(e.createdAt)})]}),Object(g.jsx)("h4",{className:"notif-card-txt",children:e.txt}),"from"===e.type&&Object(g.jsx)(l.b,{to:"/host/".concat(this.props.loggedInUser._id),children:"Read More"}),"to"===e.type&&Object(g.jsx)(l.b,{to:"/orders",children:"Read More"})]},Math.random()))),Object(g.jsx)("button",{onClick:this.onClearNotif,children:"Clear all"})]})})}}class st extends a.Component{componentDidUpdate(e){e.modalType!==this.props.modalType&&""!==this.props.modalType&&this.props.openDynamicModal(this.props.modalType)}render(){const{modalPosition:e}=this.props;return e&&e.top&&e.left?Object(g.jsxs)(i.a.Fragment,{children:[Object(g.jsx)("div",{className:"modal-bg"}),Object(g.jsx)("section",{className:"dynamic-modal",style:e,children:this.props.children})]}):""}}class at extends a.Component{render(){return Object(g.jsx)("section",{className:"user-msg",children:this.props.children})}}class it extends a.Component{constructor(){var e;super(...arguments),e=this,this.state={userMsg:"",isUserMsg:!1,modalType:"",dynamicModal:{modalContent:"",modalPosition:{top:0,left:0,height:0,width:0}},topRatedStays:[],nearbayStays:[],isFooterOn:!0,currPage:"home",isNewNotif:!1},this.onOrderIn=async e=>{const t=this.props.loggedInUser;if(t._id===e.host._id){const t=await I.getById(e.host._id),s={txt:"".concat(e.user.fullname," booked your stay"),createdAt:new Date,imgUrl:e.user.imgUrl,fullname:e.user.fullname,type:"from"};this.setNotifStatus(!0),t.notifications||(t.notifications=[]),t.notifications.unshift(s),this.props.updateUser(t)}else if(t._id===e.user._id){const s={txt:"Your order has been sent to ".concat(e.host.fullname),createdAt:new Date,imgUrl:e.host.imgUrl,fullname:e.host.fullname,type:"to"};this.setNotifStatus(!0),t.notifications||(t.notifications=[]),t.notifications.unshift(s),this.props.updateUser(t)}},this.setNotifStatus=e=>{this.setState({isNewNotif:e})},this.loadRated=async()=>{const e=await m.getTopRatedStays();this.setState({topRatedStays:e})},this.loadNearby=async()=>{const e=await m.getNearbyStays("portugal");this.setState({nearbayStays:e})},this.onSearch=e=>{this.props.addTrip(e),this.props.loadStays(e)},this.toggleMsgModal=e=>{this.setState({userMsg:e,isUserMsg:!0}),setTimeout((()=>{this.setState({isUserMsg:!1})}),4e3),setTimeout((()=>{this.setState({userMsg:""})}),6e3)},this.setModalContent=(e,t)=>{this.setState({dynamicModal:e,modalType:t})},this.closeDynamicModal=e=>{"scroll"!==e.type?e.target.closest(".dynamic-modal")||"BUTTON"!==e.target.nodeName&&this.setState({modalType:""},(()=>{window.removeEventListener("click",this.closeDynamicModal,!0),window.removeEventListener("scroll",this.closeDynamicModal,!0)})):this.setState({modalType:""},(()=>{window.removeEventListener("click",this.closeDynamicModal,!0),window.removeEventListener("scroll",this.closeDynamicModal,!0)}))},this.openDynamicModal=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;s&&"logout"===s.target.innerText?e.setState({modalType:""}):e.setState({modalType:t},(()=>{window.addEventListener("click",e.closeDynamicModal,!0),window.addEventListener("scroll",e.closeDynamicModal,!0)}))},this.setFooterDisplay=e=>{this.setState({isFooterOn:e})},this.setHomePage=e=>{this.setState({currPage:e})}}async componentDidMount(){this.loadRated(),this.loadNearby(),await L.setup(),await L.on("ORDER_IN",this.onOrderIn)}async componentWillUnmount(){await L.off("ORDER_IN",this.onOrderIn),L.terminate()}render(){const{stays:e,orders:t,updateUser:s,trip:a,addTrip:i,removeTrip:c,loggedInUser:n,logout:r,loadStays:d,loadOrders:h,removeOrder:j,loadWishlist:p,updateStay:m,login:b,updateOrder:u}=this.props,{userMsg:O,isUserMsg:x,modalType:y,dynamicModal:v,topRatedStays:f,nearbayStays:N,isFooterOn:S,currPage:w,isNewNotif:C}=this.state;return Object(g.jsxs)(l.a,{children:[Object(g.jsx)(fe,{trip:a,addTrip:i,removeTrip:c,modalType:y,onSearch:this.onSearch,loggedInUser:n,logout:r,openDynamicModal:this.openDynamicModal,closeDynamicModal:this.closeDynamicModal,setModalContent:this.setModalContent,currPage:w,loadStays:d,isNewNotif:C}),Object(g.jsxs)(o.c,{children:[Object(g.jsx)(o.a,{path:"/login",render:e=>Object(g.jsx)(me,{...e,setFooterDisplay:this.setFooterDisplay})}),Object(g.jsx)(o.a,{path:"/orders",render:e=>Object(g.jsx)(Xe,{...e,loadOrders:h,orders:t,loggedInUser:n,removeOrder:j,toggleMsgModal:this.toggleMsgModal,setFooterDisplay:this.setFooterDisplay,setHomePage:this.setHomePage})}),Object(g.jsx)(o.a,{path:"/host/:userId",render:e=>Object(g.jsx)(Je,{...e,loggedInUser:n,updateUser:s,toggleMsgModal:this.toggleMsgModal,loadOrders:h,orders:t,setFooterDisplay:this.setFooterDisplay,setHomePage:this.setHomePage,updateOrder:u})}),Object(g.jsx)(o.a,{path:"/host",render:e=>Object(g.jsx)(et,{...e,loggedInUser:n,setFooterDisplay:this.setFooterDisplay})}),Object(g.jsx)(o.a,{path:"/wishlist",render:t=>Object(g.jsx)(he,{...t,stays:e,loadWishlist:p,loggedInUser:n,toggleMsgModal:this.toggleMsgModal,login:b,setHomePage:this.setHomePage,updateUser:s,trip:a,addTrip:i})}),Object(g.jsx)(o.a,{path:"/stay/:stayId",render:e=>Object(g.jsx)(ee,{...e,onSearch:this.onSearch,loggedInUser:n,toggleMsgModal:this.toggleMsgModal,login:b,openDynamicModal:this.openDynamicModal,modalType:y,updateStay:m,updateUser:s,setModalContent:this.setModalContent,setHomePage:this.setHomePage,setHostSocket:this.setHostSocket})}),Object(g.jsx)(o.a,{path:"/explore",render:t=>Object(g.jsx)(de,{...t,trip:a,loadStays:d,stays:e,updateUser:s,loggedInUser:n,openDynamicModal:this.openDynamicModal,closeDynamicModal:this.closeDynamicModal,setModalContent:this.setModalContent,setHomePage:this.setHomePage,toggleMsgModal:this.toggleMsgModal,login:b,addTrip:i})}),Object(g.jsx)(o.a,{path:"/user",render:e=>Object(g.jsx)(ae,{...e,updateUser:s,setHomePage:this.setHomePage,setFooterDisplay:this.setFooterDisplay})}),Object(g.jsx)(o.a,{path:"/notif",render:e=>Object(g.jsx)(tt,{...e,updateUser:s,loggedInUser:n,setHomePage:this.setHomePage,setFooterDisplay:this.setFooterDisplay,setNotifStatus:this.setNotifStatus})}),Object(g.jsx)(o.a,{path:"/",render:t=>Object(g.jsx)(xe,{...t,onSearch:this.onSearch,stays:e,loggedInUser:n,loadStays:d,topRatedStays:f,nearbayStays:N,setHomePage:this.setHomePage,addTrip:i})})]}),S&&Object(g.jsx)(Se,{onSearch:this.onSearch,stays:e,topRatedStays:f,nearbayStays:N}),Object(g.jsx)(st,{openDynamicModal:this.openDynamicModal,modalPosition:v.modalPosition,modalType:y,children:v.modalContent}),Object(g.jsx)(at,{children:Object(g.jsx)("section",{className:"user-msg ".concat(x&&"on"," "),children:O})})]})}}const ct={loadStays:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{guests:{adults:1,kids:0},loc:{address:""},time:{checkIn:"",checkOut:""}};return async t=>{try{t({type:"SET_STAYS",stays:await m.query(e)})}catch(s){console.log("StayActions: err in loadStays",s)}}},addTrip:function(e){return t=>{t({type:"SET_TRIP",trip:k.add(e)})}},updateUser:function(e){return async t=>{try{t({type:"UPDATE_USER",user:await I.update(e)})}catch(s){console.log("UserActions: err in updateUser",s)}}},loadUsers:P,loadTrip:function(){return e=>{e({type:"SET_TRIP",trip:k.query()})}},removeTrip:function(){return e=>{k.remove(),e({type:"REMOVE_TRIP"})}},logout:R,removeStay:Pe,loadHostStays:Ee,loadOrders:function(e){return async t=>{try{t({type:"SET_ORDERS",orders:await M.query(e)})}catch(s){console.log("OrderActions: err in loadOrders",s)}}},removeOrder:function(e){return async t=>{try{await M.remove(e),t({type:"REMOVE_ORDER",orderId:e})}catch(s){console.log("OrderActions: err in removeOrder",s)}}},loadWishlist:function(e){return async t=>{try{t({type:"SET_WISH_STAYS",stays:await m.getUserWishlist(e)})}catch(s){console.log("StayActions: err in loadWishlist",s)}}},updateStay:_e,login:E,updateOrder:function(e){return async t=>{try{t({type:"UPDATE_ORDER",order:await M.update(e)})}catch(s){console.log("StayActions: err in update Stay",s)}}}},nt=Object(S.b)((e=>({stays:e.stayModule.stays,orders:e.orderModule.orders,trip:e.tripModule.trip,users:e.userModule.users,loggedInUser:e.userModule.loggedInUser})),ct)(it);var lt=e=>{e&&e instanceof Function&&s.e(3).then(s.bind(null,380)).then((t=>{let{getCLS:s,getFID:a,getFCP:i,getLCP:c,getTTFB:n}=t;s(e),a(e),i(e),c(e),n(e)}))},ot=s(36),rt=s(160);const dt={stays:[]};let ht=null;sessionStorage.loggedinUser&&(ht=JSON.parse(sessionStorage.loggedinUser));const jt={loggedInUser:ht,users:[]};const pt={orders:[]};let mt={guests:{adults:1,kids:0,baby:0},loc:{address:""},time:{checkIn:"",checkOut:""}};localStorage.trip&&(mt=JSON.parse(localStorage.trip));const bt={trip:mt};const ut={isLoading:!1};const gt=Object(ot.b)({systemModule:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"LOADING_START":return{...e,isLoading:!0};case"LOADING_DONE":return{...e,isLoading:!1};default:return e}},orderModule:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_ORDERS":return{...e,orders:t.orders};case"ADD_ORDER":return{...e,orders:[...e.orders,t.order]};case"REMOVE_ORDER":return{...e,orders:e.orders.filter((e=>e._id!==t.orderId))};case"UPDATE_ORDER":return{...e,orders:e.orders.map((e=>e._id===t.order._id?t.order:e))};default:return e}},stayModule:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_HOST_STAYS":case"SET_WISH_STAYS":case"SET_STAYS":return{...e,stays:t.stays};case"ADD_STAY":return{...e,stays:[...e.stays,t.stay]};case"REMOVE_STAY":return{...e,stays:e.stays.filter((e=>e._id!==t.stayId))};case"UPDATE_STAY":return{...e,stays:e.stays.map((e=>e._id===t.stay._id?t.stay:e))};default:return e}},userModule:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_USER":return{...e,loggedInUser:t.user};case"REMOVE_USER":return{...e,users:e.users.filter((e=>e._id!==t.userId))};case"SET_USERS":return{...e,users:t.users};case"UPDATE_USER":return{loggedInUser:{...t.user,notifications:[...t.user.notifications]},users:e.users.map((e=>e._id===t.user._id?t.user:e))};default:return e}},tripModule:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bt,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_TRIP":return{trip:t.trip};case"ADD_TRIP":return{...e,stays:[...e.stays,t.stay]};case"REMOVE_TRIP":return{trip:null};default:return e}}}),Ot=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ot.c,xt=Object(ot.d)(gt,Ot(Object(ot.a)(rt.a)));s(373),s(374),s(375),s(376);n.a.render(Object(g.jsx)(i.a.StrictMode,{children:Object(g.jsx)(S.a,{store:xt,children:Object(g.jsx)(nt,{})})}),document.getElementById("root")),lt()}},[[377,1,2]]]);
//# sourceMappingURL=main.fb50db33.chunk.js.map